(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{666:function(e,t,n){"use strict";var r=n(698);n.o(r,"CircleDrawer")&&n.d(t,"CircleDrawer",(function(){return r.CircleDrawer})),n.o(r,"CircleHover")&&n.d(t,"CircleHover",(function(){return r.CircleHover})),n.o(r,"CircleViewer")&&n.d(t,"CircleViewer",(function(){return r.CircleViewer})),n.o(r,"ContourDrawer")&&n.d(t,"ContourDrawer",(function(){return r.ContourDrawer})),n.o(r,"ContourHover")&&n.d(t,"ContourHover",(function(){return r.ContourHover})),n.o(r,"ContourViewer")&&n.d(t,"ContourViewer",(function(){return r.ContourViewer})),n.o(r,"CornerstoneFileSingleImage")&&n.d(t,"CornerstoneFileSingleImage",(function(){return r.CornerstoneFileSingleImage})),n.o(r,"CornerstoneSeriesImage")&&n.d(t,"CornerstoneSeriesImage",(function(){return r.CornerstoneSeriesImage})),n.o(r,"CornerstoneSingleImage")&&n.d(t,"CornerstoneSingleImage",(function(){return r.CornerstoneSingleImage})),n.o(r,"CornerstoneStaticSeriesImage")&&n.d(t,"CornerstoneStaticSeriesImage",(function(){return r.CornerstoneStaticSeriesImage})),n.o(r,"CornerstoneViewer")&&n.d(t,"CornerstoneViewer",(function(){return r.CornerstoneViewer})),n.o(r,"DCMImage")&&n.d(t,"DCMImage",(function(){return r.DCMImage})),n.o(r,"HeatmapViewer")&&n.d(t,"HeatmapViewer",(function(){return r.HeatmapViewer})),n.o(r,"ImageStoreProvider")&&n.d(t,"ImageStoreProvider",(function(){return r.ImageStoreProvider})),n.o(r,"InsightViewer")&&n.d(t,"InsightViewer",(function(){return r.InsightViewer})),n.o(r,"InsightViewerContainer")&&n.d(t,"InsightViewerContainer",(function(){return r.InsightViewerContainer})),n.o(r,"InsightViewerTestController")&&n.d(t,"InsightViewerTestController",(function(){return r.InsightViewerTestController})),n.o(r,"LeftBottomHolder")&&n.d(t,"LeftBottomHolder",(function(){return r.LeftBottomHolder})),n.o(r,"LeftTopHolder")&&n.d(t,"LeftTopHolder",(function(){return r.LeftTopHolder})),n.o(r,"PointViewer")&&n.d(t,"PointViewer",(function(){return r.PointViewer})),n.o(r,"ProgressViewer")&&n.d(t,"ProgressViewer",(function(){return r.ProgressViewer})),n.o(r,"RightBottomHolder")&&n.d(t,"RightBottomHolder",(function(){return r.RightBottomHolder})),n.o(r,"RightTopHolder")&&n.d(t,"RightTopHolder",(function(){return r.RightTopHolder})),n.o(r,"StrokeText")&&n.d(t,"StrokeText",(function(){return r.StrokeText})),n.o(r,"adjust")&&n.d(t,"adjust",(function(){return r.adjust})),n.o(r,"blockStyle")&&n.d(t,"blockStyle",(function(){return r.blockStyle})),n.o(r,"fetchBuffer")&&n.d(t,"fetchBuffer",(function(){return r.fetchBuffer})),n.o(r,"fileToBuffer")&&n.d(t,"fileToBuffer",(function(){return r.fileToBuffer})),n.o(r,"installWADOImageLoader")&&n.d(t,"installWADOImageLoader",(function(){return r.installWADOImageLoader})),n.o(r,"mapNpyBufferToImages")&&n.d(t,"mapNpyBufferToImages",(function(){return r.mapNpyBufferToImages})),n.o(r,"pan")&&n.d(t,"pan",(function(){return r.pan})),n.o(r,"unloadImage")&&n.d(t,"unloadImage",(function(){return r.unloadImage})),n.o(r,"useContour")&&n.d(t,"useContour",(function(){return r.useContour})),n.o(r,"useImageLoadedTime")&&n.d(t,"useImageLoadedTime",(function(){return r.useImageLoadedTime})),n.o(r,"useImageProgress")&&n.d(t,"useImageProgress",(function(){return r.useImageProgress})),n.o(r,"useImageStore")&&n.d(t,"useImageStore",(function(){return r.useImageStore})),n.o(r,"useInsightViewerSync")&&n.d(t,"useInsightViewerSync",(function(){return r.useInsightViewerSync})),n.o(r,"useSeriesImagePosition")&&n.d(t,"useSeriesImagePosition",(function(){return r.useSeriesImagePosition})),n.o(r,"useSeriesImageScroll")&&n.d(t,"useSeriesImageScroll",(function(){return r.useSeriesImageScroll})),n.o(r,"useViewportMirroring")&&n.d(t,"useViewportMirroring",(function(){return r.useViewportMirroring})),n.o(r,"zoom")&&n.d(t,"zoom",(function(){return r.zoom}));var o=n(699);n.d(t,"installWADOImageLoader",(function(){return o.a}));n(700);var i=n(701);n.d(t,"unloadImage",(function(){return i.a}));var s=n(702);n.d(t,"InsightViewer",(function(){return s.a}));var a=n(706);n.d(t,"ContourViewer",(function(){return a.a}));var c=n(707);n.d(t,"ContourDrawer",(function(){return c.a}));var u=n(710);n.d(t,"ContourHover",(function(){return u.a}));var l=n(743);n.d(t,"HeatmapViewer",(function(){return l.a}));var h=n(711);n.d(t,"InsightViewerContainer",(function(){return h.a})),n.d(t,"LeftBottomHolder",(function(){return h.b})),n.d(t,"LeftTopHolder",(function(){return h.c})),n.d(t,"RightBottomHolder",(function(){return h.d})),n.d(t,"RightTopHolder",(function(){return h.e}));var d=n(712);n.d(t,"ProgressViewer",(function(){return d.a}));var p=n(746);n.d(t,"PointViewer",(function(){return p.a}));var m=n(713);n.d(t,"CircleViewer",(function(){return m.a}));var g=n(714);n.d(t,"CircleDrawer",(function(){return g.a}));var v=n(716);n.d(t,"CircleHover",(function(){return v.a}));var f=n(717);n.d(t,"DCMImage",(function(){return f.a}));n(718);var w=n(719);n.d(t,"InsightViewerTestController",(function(){return w.a}));var b=n(720);n.d(t,"StrokeText",(function(){return b.a}));var E=n(721);n.d(t,"CornerstoneViewer",(function(){return E.a}));var I=n(722);n.d(t,"adjust",(function(){return I.a}));var y=n(723);n.d(t,"pan",(function(){return y.a}));var x=n(724);n.d(t,"zoom",(function(){return x.a}));var C=n(725);n.d(t,"useSeriesImagePosition",(function(){return C.a}));var S=n(726);n.d(t,"useSeriesImageScroll",(function(){return S.a}));var M=n(678);n.d(t,"useImageProgress",(function(){return M.a}));var D=n(727);n.d(t,"useInsightViewerSync",(function(){return D.a}));var j=n(728);n.d(t,"useContour",(function(){return j.a}));var L=n(730);n.d(t,"useViewportMirroring",(function(){return L.a}));var V=n(731);n.d(t,"useImageLoadedTime",(function(){return V.a}));var T=n(732);n.d(t,"ImageStoreProvider",(function(){return T.a})),n.d(t,"useImageStore",(function(){return T.b}));n(676);var k=n(679);n.d(t,"CornerstoneSingleImage",(function(){return k.a}));var P=n(734);n.d(t,"CornerstoneSeriesImage",(function(){return P.a}));n(675),n(735);var R=n(736);n.d(t,"fetchBuffer",(function(){return R.a}));var _=n(737);n.d(t,"fileToBuffer",(function(){return _.a}));var O=n(738);n.d(t,"CornerstoneFileSingleImage",(function(){return O.a}));var A=n(739);n.d(t,"CornerstoneStaticSeriesImage",(function(){return A.a}));var F=n(745);n.d(t,"mapNpyBufferToImages",(function(){return F.a}));n(740);var W=n(680);n.d(t,"blockStyle",(function(){return W.a}));n(741),n(671)},671:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n.n(r);const i=Object(r.createContext)({contentWindow:window});function s({stateRef:e}){return o.a.createElement(i.Consumer,null,t=>{e(t)})}},674:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u}));var r=n(0),o=n.n(r);function i(e){let t,n,r;const o=Math.max(Math.min(e,1),0);return o<.25?(t=0,n=4*o,r=1):o<.5?(t=0,n=1,r=1+4*(.25-o)):o<.75?(t=4*(o-.5),n=1,r=0):(t=1,n=1+4*(.75-o),r=0),[255*t<<0,255*n<<0,255*r<<0]}function s({stop:e,threshold:t}){const n=function({stop:e,threshold:t}){return e<t?0:.75*(e-t)/(1-t)}({stop:e,threshold:t});if(n<=0)return[0,0,0,0];const[r,o,s]=i(e);return[r,o,s,n]}function a({width:e,height:t,threshold:n}){return Object(r.useMemo)(()=>{const r=document.createElement("canvas");if(!r)return null;const o=window.devicePixelRatio,i=e*o,a=t*o;r.setAttribute("width",i.toString()),r.setAttribute("height",a.toString());const c=r.getContext("2d");if(!c)return null;let u=i+1;for(;--u>=0;)c.beginPath(),c.fillStyle=`rgba(${s({stop:u/i,threshold:n})})`,c.fillRect(u,0,1,a),c.closePath();return r.toDataURL()},[n,e,t])}function c({threshold:e=0,width:t,height:n,...r}){const i=a({width:t,height:n,threshold:e});return i?o.a.createElement("image",Object.assign({},r,{xlinkHref:i,width:t,height:n})):null}function u(e,t){const n=e[0].length,r=e.length,o=document.createElement("canvas").getContext("2d").createImageData(n,r),s=o.data;let a=-1;for(;++a<r;){let r=-1;for(;++r<n;){const o=4*(a*n+r),c=e[a][r];if(c<t)s[o]=0,s[o+1]=0,s[o+2]=0,s[o+3]=0;else{const e=(c-t)/(1-t),[n,r,a]=i(e);s[o]=n,s[o+1]=r,s[o+2]=a,s[o+3]=196*e<<0}}}return o}},675:function(e,t,n){"use strict";async function r(e){return new Promise(t=>{setTimeout(t,e)})}n.d(t,"a",(function(){return o}));class o{constructor(e={}){this.options=e,this.loadImage=({imageId:e,options:t})=>"number"===typeof this.options.timeout?Promise.race([cornerstone.loadImage(e,t),r(this.options.timeout).then(()=>{throw new Error("TIMEOUT")})]):cornerstone.loadImage(e,t)}}},676:function(e,t,n){"use strict";function r(e){const t=e.detail;if(t&&"string"===typeof t.url&&"string"===typeof t.imageId&&"number"===typeof t.loaded&&"number"===typeof t.total&&"number"===typeof t.percentComplete)return t}n.d(t,"a",(function(){return r}))},678:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){const[t,n]=Object(r.useState)(null);return Object(r.useEffect)(()=>{if(e){const t=e.progress.subscribe(e=>{n(e<1?e:null)});return()=>{t.unsubscribe()}}n(null)},[e]),t}},679:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(659),o=n(675),i=n(676),s=n(733);const a=new o.a;class c{constructor(e,t={}){this.imageId=e,this.options=t,this._imageSubject=void 0,this._progressSubject=void 0,this._cancel=[],this._loader=void 0,this._destoyed=!1,this.destroy=()=>{this.options&&"function"===typeof this.options.unload&&this.options.unload(this.imageId),cornerstone.events.removeEventListener("cornerstoneimageloadprogress",this.onProgress),this._cancel.forEach(e=>e()),this._destoyed=!0},this.onProgress=e=>{const t=Object(i.a)(e);t&&t.imageId===this.imageId&&this._progressSubject.next(Math.min(t.loaded/t.total,.99))},this.loadImage=async e=>{try{const t=await this._loader.loadImage({imageId:e,options:{loader:Object(s.a)(e=>this._cancel.push(e))}});cornerstone.events.removeEventListener("cornerstoneimageloadprogress",this.onProgress),this._destoyed||(this._imageSubject.next(t),this._progressSubject.next(1))}catch(t){this._destoyed||(console.warn(`It will retry loadImage(${e}):`,t),this.loadImage(e))}},this._imageSubject=new r.a(null),this._progressSubject=new r.a(0),this._loader=t.loader||a,cornerstone.events.addEventListener("cornerstoneimageloadprogress",this.onProgress),this.loadImage(e)}get image(){return this._imageSubject.asObservable()}get progress(){return this._progressSubject.asObservable()}}},680:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(32);const o=r.css`
  --contour-viewer-color: #ffffff;
  --contour-viewer-focused-color: rgb(255, 194, 17);
  --contour-viewer-stroke-width: 3px;
  --contour-viewer-focused-stroke-width: 6px;
  --contour-viewer-fill-color: rgba(0, 0, 0, 0.2);
  --contour-viewer-focused-fill-color: rgba(0, 0, 0, 0.4);

  --contour-drawer-color: rgb(255, 224, 0);
  --contour-drawer-stroke-width: 4px;
  --contour-drawer-fill-color: rgba(255, 224, 0, 0.2);

  --pin-color: #ffffff;
  --pin-focused-color: rgb(255, 194, 17);
`,i=r.css`
  :root {
    ${o};
  }
`},698:function(e,t){},699:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));let r=!1;function o(){r||(r=!0,cornerstoneWADOImageLoader.external.dicomParser=dicomParser,cornerstoneWADOImageLoader.external.cornerstone=cornerstone)}},700:function(e,t,n){"use strict"},701:function(e,t,n){"use strict";function r(e){function t(e){var t,n,r;/^wadouri:/.test(e)&&(null===(t=cornerstoneWADOImageLoader)||void 0===t||null===(n=t.wadouri)||void 0===n||null===(r=n.dataSetCacheManager)||void 0===r||r.unload(e))}Array.isArray(e)?e.forEach(e=>t(e)):"string"===typeof e&&t(e)}n.d(t,"a",(function(){return r}))},702:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),o=n.n(r),i=n(671),s=n(703),a=n(704),c=n(705);class u extends r.Component{constructor(...e){super(...e),this.element=void 0,this.currentViewport=null,this.currentImage=null,this.teardownPanInteraction=null,this.teardownAdjustInteraction=null,this.teardownZoomInteraction=null,this.imageSubscription=null,this.needImageInitialize=!0,this.contentWindow=window,this.elementRef=e=>{this.element=e,e&&(!0===this.props.pan&&this.startPanInteraction(this.props.pan),!0===this.props.adjust&&this.startAdjustInteraction(this.props.adjust),!0===this.props.zoom&&this.startZoomInteraction(this.props.zoom))},this.initImage=e=>{cornerstone.disable(this.element),cornerstone.enable(this.element,{renderer:"webgl"});let t=this.getDefaultViewport(e,this.element);if(!t)throw new Error("defaultViewport\ub294 null\uc77c \uc218 \uc5c6\ub2e4.");if(Array.isArray(this.props.defaultViewportTransforms)){const e=t.scale;for(const n of this.props.defaultViewportTransforms){const r=n({element:this.element,currentViewport:t,minScale:e,maxScale:3});t={...t,...r}}}t={...t,hflip:this.props.flip,invert:this.props.invert},cornerstone.displayImage(this.element,e,t),this.setImage(e),this.setViewport(t),this.startPanInteraction(this.props.pan),this.startAdjustInteraction(this.props.adjust),this.startZoomInteraction(this.props.zoom)},this.subscribeImage=e=>{if(e)if(e.voiLUT=void 0,this.needImageInitialize)this.needImageInitialize=!1,this.initImage(e);else{if(!this.currentViewport)throw new Error("\uc5b4\ub5a4 \uc0c1\ud669\uc778\uc9c0 \ud655\uc778 \ud544\uc694!!!");cornerstone.displayImage(this.element,e,this.currentViewport)}},this.onImageRenderered=e=>{const t=e.detail;t&&t.canvasContext&&t.element&&t.enabledElement&&t.image&&"number"===typeof t.renderTimeInMs&&t.viewport?(this.currentViewport=t.viewport,this.props.updateCornerstoneRenderData(t)):console.error("CornerstoneEventData\uc5d0 \uc5c6\ub294 \uc815\ubcf4\uac00 \uc788\ub2e4???",t)},this.startPanInteraction=e=>{this.teardownPanInteraction&&this.teardownPanInteraction();const t=e instanceof this.contentWindow.HTMLElement?e:!0===e?this.element:null;t&&(this.teardownPanInteraction=Object(a.a)({element:t,getCurrentViewport:()=>this.currentViewport,onMove:e=>this.updateCurrentViewport({translation:e}),onEnd:()=>{},contentWindow:this.contentWindow}))},this.startAdjustInteraction=e=>{this.teardownAdjustInteraction&&this.teardownAdjustInteraction();const t=e instanceof this.contentWindow.HTMLElement?e:!0===e?this.element:null;t&&(this.teardownAdjustInteraction=Object(s.a)({element:t,getCurrentViewport:()=>this.currentViewport,onMove:e=>this.updateCurrentViewport({voi:e}),onEnd:()=>{},contentWindow:this.contentWindow}))},this.startZoomInteraction=e=>{this.teardownZoomInteraction&&this.teardownZoomInteraction();const t=e instanceof this.contentWindow.HTMLElement?e:!0===e?this.element:null;t&&(this.teardownZoomInteraction=Object(c.a)({element:t,getMinMaxScale:()=>[this.getMinScale(),this.getMaxScale()],getCurrentViewport:()=>this.currentViewport,onZoom:e=>this.updateCurrentViewport(e),contentWindow:this.contentWindow}))},this.getDefaultViewport=(e,t)=>e&&t?cornerstone.getDefaultViewportForImage(t,e):null,this.getMinScale=()=>{const e=this.getDefaultViewport(this.currentImage,this.element);if(!e)throw new Error("viewport\uac00 \uc815\uc0c1\uc801\uc73c\ub85c \uc640\uc57c\ub9cc \ud55c\ub2e4");return e.scale},this.getMaxScale=()=>3,this.updateViewport=e=>{this.currentViewport&&this.updateCurrentViewport(e)},this.getViewportTransformParams=()=>({element:this.element,minScale:this.getMinScale(),maxScale:this.getMaxScale(),currentViewport:this.currentViewport}),this.setCornerstoneImage=e=>{this.needImageInitialize=!0,this.setImage(null),this.imageSubscription&&(this.imageSubscription.unsubscribe(),this.imageSubscription=null),this.imageSubscription=e.image.subscribe(this.subscribeImage)},this.setImage=e=>{this.currentImage=e},this.setViewport=e=>{this.currentViewport=e,cornerstone.setViewport(this.element,this.currentViewport)},this.updateCurrentViewport=e=>{if(!this.currentViewport)throw new Error("viewport\uac00 \uc5c6\ub294 \uc0c1\ud0dc\uc5d0\uc11c \uc2e4\ud589\ub418\uba74 \uc548\ub41c\ub2e4");const t="function"===typeof e?e(this.currentViewport):e;this.currentViewport={...this.currentViewport,...t},cornerstone.setViewport(this.element,this.currentViewport)}}render(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.a,{stateRef:({contentWindow:e})=>this.contentWindow=e}),o.a.createElement("div",{ref:this.elementRef,style:{width:this.props.width,height:this.props.height}}))}componentDidMount(){this.element.addEventListener(cornerstone.EVENTS.IMAGE_RENDERED,this.onImageRenderered),this.setCornerstoneImage(this.props.image)}componentWillUnmount(){this.element.removeEventListener(cornerstone.EVENTS.IMAGE_RENDERED,this.onImageRenderered),cornerstone.disable(this.element),this.imageSubscription&&this.imageSubscription.unsubscribe(),this.teardownPanInteraction&&this.teardownPanInteraction(),this.teardownAdjustInteraction&&this.teardownAdjustInteraction(),this.teardownZoomInteraction&&this.teardownZoomInteraction()}componentDidUpdate(e){const{width:t,height:n,flip:r,invert:o,pan:i,adjust:s,zoom:a,resetTime:c,image:u}=this.props,l=this.getDefaultViewport(this.currentImage,this.element);if(e.pan!==i&&this.startPanInteraction(i),e.adjust!==s&&this.startAdjustInteraction(s),e.zoom!==a&&this.startZoomInteraction(a),l&&(e.resetTime!==c?this.updateCurrentViewport({...l,hflip:r,invert:l.invert?!o:o}):e.flip===r&&e.invert===o||this.updateCurrentViewport({hflip:r,invert:l.invert?!o:o})),(e.width!==t||e.height!==n)&&this.currentImage){cornerstone.resize(this.element);const e=cornerstone.getViewport(this.element);if(!e)throw new Error("getViewport() is returns not a Viewport");this.setViewport(e)}e.image!==u&&this.setCornerstoneImage(u)}}},703:function(e,t,n){"use strict";function r({element:e,getCurrentViewport:t,onMove:n,onEnd:r,contentWindow:o}){let i,s,a,c;function u(){e.addEventListener("mousedown",m),e.addEventListener("touchstart",h)}function l(){e.removeEventListener("mousedown",m),e.removeEventListener("touchstart",h)}function h(e){if(e.targetTouches.length>1&&(o.removeEventListener("touchmove",d),o.removeEventListener("touchend",p),o.removeEventListener("touchcancel",p),u()),1!==e.targetTouches.length)return;e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault();const n=t();n&&(l(),i=e.targetTouches[0].pageX,s=e.targetTouches[0].pageY,a=n.voi.windowCenter,c=n.voi.windowWidth,o.addEventListener("touchmove",d),o.addEventListener("touchend",p),o.addEventListener("touchcancel",p))}function d(e){if(1===e.targetTouches.length&&1===e.changedTouches.length||(o.removeEventListener("touchmove",d),o.removeEventListener("touchend",p),o.removeEventListener("touchcancel",p),u()),e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault(),!t())return;const r=e.targetTouches[0].pageX-i,l=e.targetTouches[0].pageY-s;n({windowWidth:Math.max(c+r,1),windowCenter:Math.max(a+l,1)})}function p(e){o.removeEventListener("touchmove",d),o.removeEventListener("touchend",p),o.removeEventListener("touchcancel",p),u(),r()}function m(n){if(0!==n.button)return;n.stopPropagation(),n.stopImmediatePropagation(),n.preventDefault();const r=t();r&&(l(),i=n.pageX,s=n.pageY,a=r.voi.windowCenter,c=r.voi.windowWidth,o.addEventListener("mousemove",g),o.addEventListener("mouseup",v),e.addEventListener("mouseleave",v))}function g(e){e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault();const t=e.pageX-i,r=e.pageY-s;n({windowWidth:Math.max(c+t,1),windowCenter:Math.max(a+r,1)})}function v(t){0===t.button&&(t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),o.removeEventListener("mousemove",g),o.removeEventListener("mouseup",v),e.removeEventListener("mouseleave",v),u(),r())}return u(),()=>{e.removeEventListener("mousedown",m),e.removeEventListener("touchstart",h),o.removeEventListener("mousemove",g),o.removeEventListener("mouseup",v),e.removeEventListener("mouseleave",v),o.removeEventListener("touchmove",d),o.removeEventListener("touchend",p),o.removeEventListener("touchcancel",p)}}n.d(t,"a",(function(){return r}))},704:function(e,t,n){"use strict";function r({element:e,getCurrentViewport:t,onMove:n,onEnd:r,contentWindow:o}){let i,s,a,c;function u(){e.addEventListener("mousedown",m),e.addEventListener("touchstart",h)}function l(){e.removeEventListener("mousedown",m),e.removeEventListener("touchstart",h)}function h(e){if(e.targetTouches.length>1&&(o.removeEventListener("touchmove",d),o.removeEventListener("touchend",p),o.removeEventListener("touchcancel",p),u()),1!==e.targetTouches.length)return;e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault();const n=t();n&&(l(),i=e.targetTouches[0].pageX,s=e.targetTouches[0].pageY,a=n.translation.x,c=n.translation.y,o.addEventListener("touchmove",d),o.addEventListener("touchend",p),o.addEventListener("touchcancel",p))}function d(e){1===e.targetTouches.length&&1===e.changedTouches.length||(o.removeEventListener("touchmove",d),o.removeEventListener("touchend",p),o.removeEventListener("touchcancel",p),u()),e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault();const r=t();if(!r)return;const l=(e.targetTouches[0].pageX-i)/r.scale,h=(e.targetTouches[0].pageY-s)/r.scale;n({x:a+l,y:c+h})}function p(e){o.removeEventListener("touchmove",d),o.removeEventListener("touchend",p),o.removeEventListener("touchcancel",p),u(),r()}function m(n){if(0!==n.button)return;n.stopPropagation(),n.stopImmediatePropagation(),n.preventDefault();const r=t();r&&(l(),i=n.pageX,s=n.pageY,a=r.translation.x,c=r.translation.y,o.addEventListener("mousemove",g),o.addEventListener("mouseup",v),e.addEventListener("mouseleave",v))}function g(e){e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault();const r=t();if(!r)return;const o=(e.pageX-i)/r.scale,u=(e.pageY-s)/r.scale;n({x:a+o,y:c+u})}function v(t){0===t.button&&(t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),o.removeEventListener("mousemove",g),o.removeEventListener("mouseup",v),e.removeEventListener("mouseleave",v),u(),r())}return u(),()=>{e.removeEventListener("mousedown",m),o.removeEventListener("mousemove",g),o.removeEventListener("mouseup",v),e.removeEventListener("mouseleave",v),e.removeEventListener("touchstart",h),o.removeEventListener("touchmove",d),o.removeEventListener("touchend",p),o.removeEventListener("touchcancel",p)}}n.d(t,"a",(function(){return r}))},705:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(643),o=n(642);function i({element:e,getMinMaxScale:t,getCurrentViewport:n,onZoom:i,contentWindow:s}){function a(r){r.preventDefault(),r.stopPropagation(),r.stopImmediatePropagation();const[o,a]=t(),c=n();if(!c)return;const u=r.deltaY>0?1:-1,l=Math.max(o,Math.min(a,c.scale-.03*u));if(c.scale===l)return;const{top:h,left:d,width:p,height:m}=e.getBoundingClientRect(),g=r.pageX-s.scrollX-(d+p/2),v=r.pageY-s.scrollY-(h+m/2),f=(1-l/c.scale)*g,w=(1-l/c.scale)*v;i({translation:{x:c.translation.x+f/l,y:c.translation.y+w/l},scale:l})}let c,u,l,h;function d(t){if(2!==t.targetTouches.length)return;t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault();const r=n();if(!r)return;h=r.scale,l=r.translation,c=[{x:t.targetTouches[0].pageX,y:t.targetTouches[0].pageY},{x:t.targetTouches[1].pageX,y:t.targetTouches[1].pageY}];const o=Math.abs(c[0].x-c[1].x),i=Math.abs(c[0].y-c[1].y);u=Math.sqrt(Math.pow(o,2)+Math.pow(i,2)),e.removeEventListener("touchstart",d),e.addEventListener("touchmove",p),e.addEventListener("touchend",m),e.addEventListener("touchcancel",m)}function p(e){if(2!==e.targetTouches.length||2!==e.changedTouches.length)return;e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault();const t=[{x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY},{x:e.changedTouches[1].pageX,y:e.changedTouches[1].pageY}],n=Math.abs(t[0].x-t[1].x),r=Math.abs(t[0].y-t[1].y),o=Math.sqrt(Math.pow(n,2)+Math.pow(r,2)),s=h*(o/u),a=((t[0].x+t[1].x)/2-(c[0].x+c[1].x)/2)/s,d=((t[0].y+t[1].y)/2-(c[0].y+c[1].y)/2)/s,p={x:l.x+a,y:l.y+d};i({translation:p,scale:s})}function m(s){const a=n();if(!a)return;const[c,u]=t();if(a.scale<c){const e=Object(o.a)(t=>{const n=Object(r.a)(t/500);t>500?(i({translation:a.translation,scale:c}),e.stop()):i({translation:a.translation,scale:a.scale+(c-a.scale)*n})})}else if(a.scale>u){const e=Object(o.a)(t=>{const n=Object(r.a)(t/500);t>500?(i({translation:a.translation,scale:u}),e.stop()):i({translation:a.translation,scale:a.scale+(u-a.scale)*n})})}e.removeEventListener("touchmove",p),e.removeEventListener("touchend",m),e.removeEventListener("touchcancel",m),e.addEventListener("touchstart",d)}return e.addEventListener("wheel",a),e.addEventListener("touchstart",d),()=>{e.removeEventListener("wheel",a),e.removeEventListener("touchstart",d),e.removeEventListener("touchmove",p),e.removeEventListener("touchend",m),e.removeEventListener("touchcancel",m)}}},706:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(602),o=n.n(r),i=n(0),s=n.n(i),a=n(32);class c extends i.Component{constructor(...e){super(...e),this.svgRef=Object(i.createRef)()}render(){const{cornerstoneRenderData:e,contours:t,focusedContour:n}=this.props;return s.a.createElement("svg",{ref:this.svgRef,className:this.props.className,style:this.props.style,width:this.props.width,height:this.props.height},t.length>0&&e&&e.element&&t.map(t=>{const r=function(e,t){return t.map(([t,n])=>{const r=cornerstone.pixelToCanvas(e,{x:t,y:n});return[r.x,r.y]})}(e.element,t.polygon),a=o()([r],1),c=t===n,u=t.dataAttrs||{};return s.a.createElement(i.Fragment,{key:"polygon"+t.id},!0===this.props.border&&s.a.createElement("polygon",Object.assign({},u,{"data-border":"border","data-id":t.id,"data-focused":c||void 0,points:r.map(([e,t])=>`${e},${t}`).join(" ")})),s.a.createElement("polygon",Object.assign({},u,{"data-id":t.id,"data-focused":c||void 0,points:r.map(([e,t])=>`${e},${t}`).join(" ")})),!0===this.props.border&&s.a.createElement("text",Object.assign({},u,{"data-border":"border","data-id":t.id,"data-focused":c||void 0,fontSize:14*Math.max(1,e.viewport.scale),x:a[0],y:a[1]}),t.label?"function"===typeof t.label?t.label(t):t.label:t.id),s.a.createElement("text",Object.assign({},u,{"data-id":t.id,"data-focused":c||void 0,fontSize:14*Math.max(1,e.viewport.scale),x:a[0],y:a[1]}),t.label?"function"===typeof t.label?t.label(t):t.label:t.id))}))}}c.defaultProps={border:!0};const u=Object(a.default)(c)`
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
  user-select: none;

  --color: #ffffff;
  --focused-color: rgb(255, 194, 17);
  --stroke-width: 3px;
  --focused-stroke-width: 6px;
  --fill-color: rgba(0, 0, 0, 0.2);
  --focused-fill-color: rgba(0, 0, 0, 0.4);

  > polygon {
    stroke-width: var(--contour-viewer-stroke-width, var(--stroke-width));
    stroke: var(--contour-viewer-color, var(--color));
    fill: var(--contour-viewer-fill-color, var(--fill-color));
    transition: stroke 120ms ease-out, stroke-width 120ms ease-out;

    &[data-focused] {
      stroke-width: var(--contour-viewer-focused-stroke-width, var(--focused-stroke-width));
      stroke: var(--contour-viewer-focused-color, var(--focused-color));
      fill: var(--contour-viewer-focused-fill-color, var(--focused-fill-color));
    }

    &[data-border] {
      stroke-width: calc(var(--contour-viewer-stroke-width, var(--stroke-width)) + 2px);
      stroke: #000000;
      fill: transparent;

      &[data-focused] {
        stroke-width: calc(var(--contour-viewer-focused-stroke-width, var(--focused-stroke-width)) + 2px);
        stroke: #000000;
      }
    }
  }

  > text {
    fill: var(--contour-viewer-color, var(--color));
    font-family: proximanova, noto_sans, sans-serif;
    font-weight: 600;
    text-anchor: middle;
    dominant-baseline: central;
    transition: fill 120ms ease-out, stroke-width 120ms ease-out;

    &[data-focused] {
      fill: var(--contour-viewer-focused-color, var(--focused-color));
    }

    &[data-border] {
      stroke-width: 4px;
      stroke: #000000;
      fill: transparent;
    }
  }
`},707:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(0),o=n.n(r),i=n(32),s=n(671),a=n(708),c=n(709);function u(e,t){return t.map(([t,n])=>{const r=cornerstone.pixelToCanvas(e,{x:t,y:n});return r.x+","+r.y}).join(" ")}class l extends r.Component{constructor(e){super(e),this.svg=null,this.element=null,this.focused=null,this.preventClickEvent=!1,this.startX=0,this.startY=0,this.contentWindow=window,this.svgRef=e=>{e&&this.svg&&this.element&&(this.deactivateInitialEvents(),this.deactivateDrawEvents(),this.canActivate(this.props)&&(this.svg=e,this.element=this.getElement(this.props),this.activateInitialEvents())),this.svg=e},this.getElement=({draw:e})=>e instanceof this.contentWindow.HTMLElement?e:this.svg,this.canActivate=({draw:e})=>e instanceof this.contentWindow.HTMLElement||!0===e,this.activateInitialEvents=()=>{this.element&&(this.element.addEventListener("mousemove",this.onMouseMoveToFindFocus),this.element.addEventListener("mousedown",this.onMouseDownToStartDraw),this.element.addEventListener("click",this.onMouseClickToRemove))},this.deactivateInitialEvents=()=>{this.element&&(this.element.removeEventListener("mousemove",this.onMouseMoveToFindFocus),this.element.removeEventListener("mousedown",this.onMouseDownToStartDraw),this.element.removeEventListener("click",this.onMouseClickToRemove))},this.onMouseMoveToFindFocus=e=>{e.stopPropagation(),this.findFocus(e.pageX,e.pageY)},this.findFocus=(e,t)=>{if(!this.props.contours||0===this.props.contours.length||!this.props.cornerstoneRenderData)return;const n=this.props.cornerstoneRenderData.element,{x:r,y:o}=cornerstone.pageToPixel(n,e,t);this.focused=Object(a.a)(this.props.contours,[r,o]),this.props.onFocus(this.focused)},this.onMouseClickToRemove=e=>{e.stopPropagation(),this.focused&&!this.preventClickEvent&&this.props.onRemove(this.focused)},this.onMouseDownToStartDraw=e=>{if(e.stopPropagation(),!this.props.cornerstoneRenderData)throw new Error("cornerstoneRenderEventData\ub97c \ucc3e\uc744 \uc218 \uc5c6\ub2e4!");this.preventClickEvent=!1,this.startX=e.pageX,this.startY=e.pageY,this.deactivateInitialEvents(),this.activateDrawEvents();const t=this.props.cornerstoneRenderData.element,{x:n,y:r}=cornerstone.pageToPixel(t,e.pageX,e.pageY);this.setState(e=>({...e,polygon:[[n,r]]}))},this.activateDrawEvents=()=>{this.element&&(this.element.addEventListener("mousemove",this.onMouseMoveToDraw),this.element.addEventListener("mouseup",this.onMouseUpToEndDraw),this.element.addEventListener("mouseleave",this.onMouseLeaveToCancelDraw),window.addEventListener("keydown",this.onKeyDownToCancelDraw))},this.deactivateDrawEvents=()=>{this.element&&(this.element.removeEventListener("mousemove",this.onMouseMoveToDraw),this.element.removeEventListener("mouseup",this.onMouseUpToEndDraw),this.element.removeEventListener("mouseleave",this.onMouseLeaveToCancelDraw),window.removeEventListener("keydown",this.onKeyDownToCancelDraw))},this.onMouseMoveToDraw=e=>{if(e.stopPropagation(),!this.props.cornerstoneRenderData)throw new Error("cornerstoneRenderEventData\ub97c \ucc3e\uc744 \uc218 \uc5c6\ub2e4!");!this.preventClickEvent&&Math.max(Math.abs(e.pageX-this.startX),Math.abs(e.pageY-this.startY))>20&&(this.preventClickEvent=!0);const t=this.props.cornerstoneRenderData.element,{x:n,y:r}=cornerstone.pageToPixel(t,e.pageX,e.pageY);this.setState(e=>({...e,polygon:[...e.polygon,[n,r]]}))},this.onMouseUpToEndDraw=e=>{e.stopPropagation(),this.deactivateDrawEvents(),this.activateInitialEvents(),this.props.onAdd(this.state.polygon,e),this.setState(e=>({...e,polygon:[]}))},this.onMouseLeaveToCancelDraw=e=>{e.stopPropagation(),this.cancelDraw()},this.onKeyDownToCancelDraw=e=>{"escape"===e.key.toLowerCase()&&(e.stopPropagation(),this.cancelDraw())},this.cancelDraw=()=>{this.deactivateDrawEvents(),this.activateInitialEvents(),this.setState(e=>({...e,polygon:[]}))},this.state={polygon:[]}}render(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.a,{stateRef:({contentWindow:e})=>this.contentWindow=e}),o.a.createElement("svg",{ref:this.svgRef,role:"figure",width:this.props.width,height:this.props.height,className:this.props.className,style:this.props.style},this.props.cornerstoneRenderData&&this.state.polygon&&this.state.polygon.length>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement("polyline",{points:u(this.props.cornerstoneRenderData.element,this.state.polygon)}),!1!==this.props.animateStroke&&o.a.createElement("polyline",{points:u(this.props.cornerstoneRenderData.element,this.state.polygon),"data-highlight":"highlight"}))))}componentDidMount(){if(!this.svg)throw new Error("<svg> is not initialized");this.canActivate(this.props)&&(this.element=this.getElement(this.props),this.activateInitialEvents())}componentDidUpdate(e){e.draw!==this.props.draw&&(this.element&&(this.deactivateInitialEvents(),this.deactivateDrawEvents()),this.canActivate(this.props)&&(this.element=this.getElement(this.props),this.activateInitialEvents()))}componentWillUnmount(){this.element&&(this.deactivateInitialEvents(),this.deactivateDrawEvents())}}const h=Object(i.default)(l)`
  position: absolute;
  top: 0;
  left: 0;

  --color: rgb(255, 224, 0);
  --stroke-width: 4px;
  --fill-color: rgba(255, 224, 0, 0.2);

  > polyline:first-child {
    stroke: var(--contour-drawer-color, var(--color));
    stroke-width: var(--contour-drawer-stroke-width, var(--stroke-width));
    fill: var(--contour-drawer-fill-color, var(--fill-color));
  }

  > polyline[data-highlight] {
    stroke: #ffffff;
    stroke-width: var(--contour-drawer-stroke-width, var(--stroke-width));
    fill: transparent;
    ${c.a}
  }
`},708:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(603),o=n.n(r);function i(e,t){return e.find(e=>o()(t,e.polygon))||null}},709:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(32);const o=r.keyframes`
  to {
    stroke-dashoffset: 0;
  }
`,i=r.css`
  stroke-dasharray: 10, 10;
  stroke-dashoffset: 1000;
  animation: ${o} 10s linear infinite;
`},710:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),o=n.n(r),i=n(32),s=n(671),a=n(708);class c extends r.Component{constructor(e){super(e),this.svg=null,this.element=null,this.focused=null,this.contentWindow=window,this.svgRef=e=>{e&&this.svg&&this.element&&(this.deactivateInitialEvents(),this.canActivate(this.props)&&(this.svg=e,this.element=this.getElement(this.props),this.activateInitialEvents())),this.svg=e},this.getElement=({hover:e})=>e instanceof this.contentWindow.HTMLElement?e:this.svg,this.canActivate=({hover:e})=>e instanceof this.contentWindow.HTMLElement||!0===e,this.activateInitialEvents=()=>{this.element&&this.element.addEventListener("mousemove",this.onMouseMoveToFindFocus)},this.deactivateInitialEvents=()=>{this.element&&this.element.removeEventListener("mousemove",this.onMouseMoveToFindFocus)},this.onMouseMoveToFindFocus=e=>{this.findFocus(e.pageX,e.pageY)},this.findFocus=(e,t)=>{if(!this.props.contours||0===this.props.contours.length||!this.props.cornerstoneRenderData)return;const n=this.props.cornerstoneRenderData.element,{x:r,y:o}=cornerstone.pageToPixel(n,e,t);this.focused=Object(a.a)(this.props.contours,[r,o]),this.props.onFocus(this.focused)},this.state={polygon:[]}}render(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.a,{stateRef:({contentWindow:e})=>this.contentWindow=e}),o.a.createElement("svg",{ref:this.svgRef,role:"figure",width:this.props.width,height:this.props.height,className:this.props.className}))}componentDidMount(){if(!this.svg)throw new Error("<svg> is not initialized");this.canActivate(this.props)&&(this.element=this.getElement(this.props),this.activateInitialEvents())}componentDidUpdate(e){e.hover!==this.props.hover&&(this.element&&this.deactivateInitialEvents(),this.canActivate(this.props)&&(this.element=this.getElement(this.props),this.activateInitialEvents()))}componentWillUnmount(){this.element&&this.deactivateInitialEvents()}}const u=Object(i.default)(c)`
  position: absolute;
  top: 0;
  left: 0;
`},711:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return c}));var r=n(32);const o=r.default.div`
  background-color: #000000;
  position: relative;
  width: ${({width:e})=>e}px;
  height: ${({height:e})=>e}px;
`,i=r.default.div`
  position: absolute;
  left: 5px;
  top: 5px;
`,s=r.default.div`
  position: absolute;
  left: 5px;
  bottom: 5px;
`,a=r.default.div`
  position: absolute;
  right: 5px;
  top: 5px;
`,c=r.default.div`
  position: absolute;
  right: 5px;
  bottom: 5px;
`},712:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(644),o=n(0),i=n.n(o),s=n(32),a=n(678);let c=0;function u({width:e,height:t,inProgress:n,image:s}){const u=Object(o.useMemo)(()=>++c,[]),d=Object(a.a)(s),{setProgress:p,unsetProgress:m}=Object(o.useContext)(l);return Object(o.useEffect)(()=>{!0===n||"number"===typeof d?p(u,d||0):m(u)},[u,d,n,p,m]),i.a.createElement(i.a.Fragment,null,(!0===n||"number"===typeof d)&&i.a.createElement(h,{style:{width:e,height:t,backgroundColor:"rgba(0, 0, 0, 0.3)"}},i.a.createElement(r.a,{size:120})),"number"===typeof d&&i.a.createElement(h,{style:{width:e,height:t}},i.a.createElement(r.a,{size:100,variant:"static",value:100*d})))}const l=Object(o.createContext)({inProgress:!1,setProgress:()=>{},unsetProgress:()=>{}});const h=s.default.div`
  position: absolute;
  top: 0;
  left: 0;
  display: flex;
  align-items: center;
  justify-content: center;
`},713:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n.n(r),i=n(32);class s extends r.Component{constructor(...e){super(...e),this.svgRef=Object(r.createRef)()}render(){const{cornerstoneRenderData:e,contours:t,focusedContour:n}=this.props;return o.a.createElement("svg",{ref:this.svgRef,className:this.props.className,style:this.props.style,width:this.props.width,height:this.props.height},t.length>0&&e&&e.element&&t.map(t=>{const{cx:i,cy:s,r:a}=function(e,t){const{x:n,y:r}=cornerstone.pixelToCanvas(e,{x:t[0][0],y:t[0][1]}),{x:o,y:i}=cornerstone.pixelToCanvas(e,{x:t[1][0],y:t[1][1]});return{cx:n,cy:r,r:Math.sqrt(Math.pow(Math.abs(o-n),2)+Math.pow(Math.abs(i-r),2))}}(e.element,t.polygon),c=t===n,u=t.dataAttrs||{};return o.a.createElement(r.Fragment,{key:"circle"+t.id},!0===this.props.border&&o.a.createElement("circle",Object.assign({},u,{"data-border":"border","data-id":t.id,"data-focused":c||void 0,cx:i,cy:s,r:a})),o.a.createElement("circle",Object.assign({},u,{"data-id":t.id,"data-focused":c||void 0,cx:i,cy:s,r:a})),!0===this.props.border&&o.a.createElement("text",Object.assign({},u,{"data-border":"border","data-id":t.id,"data-focused":c||void 0,fontSize:14*Math.max(1,e.viewport.scale),x:i,y:s}),t.label?"function"===typeof t.label?t.label(t):t.label:t.id),o.a.createElement("text",Object.assign({},u,{"data-id":t.id,"data-focused":c||void 0,fontSize:14*Math.max(1,e.viewport.scale),x:i,y:s}),t.label?"function"===typeof t.label?t.label(t):t.label:t.id))}))}}s.defaultProps={border:!0};const a=Object(i.default)(s)`
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
  user-select: none;

  --color: #ffffff;
  --focused-color: rgb(255, 194, 17);
  --stroke-width: 3px;
  --focused-stroke-width: 6px;
  --fill-color: rgba(0, 0, 0, 0.2);
  --focused-fill-color: rgba(0, 0, 0, 0.4);

  > circle {
    stroke-width: var(--contour-viewer-stroke-width, var(--stroke-width));
    stroke: var(--contour-viewer-color, var(--color));
    fill: var(--contour-viewer-fill-color, var(--fill-color));
    transition: stroke 120ms ease-out, stroke-width 120ms ease-out;

    &[data-focused] {
      stroke-width: var(--contour-viewer-focused-stroke-width, var(--focused-stroke-width));
      stroke: var(--contour-viewer-focused-color, var(--focused-color));
      fill: var(--contour-viewer-focused-fill-color, var(--focused-fill-color));
    }

    &[data-border] {
      stroke-width: calc(var(--contour-viewer-stroke-width, var(--stroke-width)) + 2px);
      stroke: #000000;
      fill: transparent;

      &[data-focused] {
        stroke-width: calc(var(--contour-viewer-focused-stroke-width, var(--focused-stroke-width)) + 2px);
        stroke: #000000;
      }
    }
  }

  > text {
    fill: var(--contour-viewer-color, var(--color));
    font-family: proximanova, noto_sans, sans-serif;
    font-weight: 600;
    text-anchor: middle;
    dominant-baseline: central;
    transition: fill 120ms ease-out, stroke-width 120ms ease-out;

    &[data-focused] {
      fill: var(--contour-viewer-focused-color, var(--focused-color));
    }

    &[data-border] {
      stroke-width: 4px;
      stroke: #000000;
      fill: transparent;
    }
  }
`},714:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),o=n.n(r),i=n(32),s=n(671),a=n(715),c=n(709);class u extends r.Component{constructor(e){super(e),this.svg=null,this.element=null,this.focused=null,this.preventClickEvent=!1,this.startX=0,this.startY=0,this.contentWindow=window,this.svgRef=e=>{e&&this.svg&&this.element&&(this.deactivateInitialEvents(),this.deactivateDrawEvents(),this.canActivate(this.props)&&(this.svg=e,this.element=this.getElement(this.props),this.activateInitialEvents())),this.svg=e},this.getElement=({draw:e})=>e instanceof this.contentWindow.HTMLElement?e:this.svg,this.canActivate=({draw:e})=>e instanceof this.contentWindow.HTMLElement||!0===e,this.activateInitialEvents=()=>{this.element&&(this.element.addEventListener("mousemove",this.onMouseMoveToFindFocus),this.element.addEventListener("mousedown",this.onMouseDownToStartDraw),this.element.addEventListener("click",this.onMouseClickToRemove))},this.deactivateInitialEvents=()=>{this.element&&(this.element.removeEventListener("mousemove",this.onMouseMoveToFindFocus),this.element.removeEventListener("mousedown",this.onMouseDownToStartDraw),this.element.removeEventListener("click",this.onMouseClickToRemove))},this.onMouseMoveToFindFocus=e=>{e.stopPropagation(),this.findFocus(e.pageX,e.pageY)},this.findFocus=(e,t)=>{if(!this.props.contours||0===this.props.contours.length||!this.props.cornerstoneRenderData)return;const n=this.props.cornerstoneRenderData.element,{x:r,y:o}=cornerstone.pageToPixel(n,e,t);this.focused=Object(a.a)(this.props.contours,[r,o]),this.props.onFocus(this.focused)},this.onMouseClickToRemove=e=>{e.stopPropagation(),this.focused&&!this.preventClickEvent&&this.props.onRemove(this.focused)},this.onMouseDownToStartDraw=e=>{if(e.stopPropagation(),!this.props.cornerstoneRenderData)throw new Error("cornerstoneRenderEventData\ub97c \ucc3e\uc744 \uc218 \uc5c6\ub2e4!");this.preventClickEvent=!1,this.startX=e.pageX,this.startY=e.pageY,this.deactivateInitialEvents(),this.activateDrawEvents();const t=this.props.cornerstoneRenderData.element,{x:n,y:r}=cornerstone.pageToPixel(t,e.pageX,e.pageY);this.setState(e=>({...e,p1:[n,r]}))},this.activateDrawEvents=()=>{this.element&&(this.element.addEventListener("mousemove",this.onMouseMoveToDraw),this.element.addEventListener("mouseup",this.onMouseUpToEndDraw),this.element.addEventListener("mouseleave",this.onMouseLeaveToCancelDraw),window.addEventListener("keydown",this.onKeyDownToCancelDraw))},this.deactivateDrawEvents=()=>{this.element&&(this.element.removeEventListener("mousemove",this.onMouseMoveToDraw),this.element.removeEventListener("mouseup",this.onMouseUpToEndDraw),this.element.removeEventListener("mouseleave",this.onMouseLeaveToCancelDraw),window.removeEventListener("keydown",this.onKeyDownToCancelDraw))},this.onMouseMoveToDraw=e=>{if(e.stopPropagation(),!this.props.cornerstoneRenderData)throw new Error("cornerstoneRenderEventData\ub97c \ucc3e\uc744 \uc218 \uc5c6\ub2e4!");!this.preventClickEvent&&Math.max(Math.abs(e.pageX-this.startX),Math.abs(e.pageY-this.startY))>20&&(this.preventClickEvent=!0);const t=this.props.cornerstoneRenderData.element,{x:n,y:r}=cornerstone.pageToPixel(t,e.pageX,e.pageY);this.setState(e=>({...e,p2:[n,r]}))},this.onMouseUpToEndDraw=e=>{e.stopPropagation(),this.deactivateDrawEvents(),this.activateInitialEvents(),this.state.p1&&this.state.p2&&this.props.onAdd([this.state.p1,this.state.p2],e),this.setState(e=>({...e,p1:null,p2:null}))},this.onMouseLeaveToCancelDraw=e=>{e.stopPropagation(),this.cancelDraw()},this.onKeyDownToCancelDraw=e=>{"escape"===e.key.toLowerCase()&&(e.stopPropagation(),this.cancelDraw())},this.cancelDraw=()=>{this.deactivateDrawEvents(),this.activateInitialEvents(),this.setState(e=>({...e,p1:null,p2:null}))},this.state={p1:null,p2:null}}render(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.a,{stateRef:({contentWindow:e})=>this.contentWindow=e}),o.a.createElement("svg",{ref:this.svgRef,role:"figure",width:this.props.width,height:this.props.height,className:this.props.className,style:this.props.style},this.props.cornerstoneRenderData&&this.state.p1&&this.state.p2&&(()=>{const{x:e,y:t}=cornerstone.pixelToCanvas(this.props.cornerstoneRenderData.element,{x:this.state.p1[0],y:this.state.p1[1]}),{x:n,y:r}=cornerstone.pixelToCanvas(this.props.cornerstoneRenderData.element,{x:this.state.p2[0],y:this.state.p2[1]}),i=Math.sqrt(Math.pow(Math.abs(n-e),2)+Math.pow(Math.abs(r-t),2));return o.a.createElement(o.a.Fragment,null,o.a.createElement("circle",{cx:e,cy:t,r:i}),!1!==this.props.animateStroke&&o.a.createElement("circle",{cx:e,cy:t,r:i,"data-highlight":"highlight"}),o.a.createElement("line",{x1:e,y1:t,x2:n,y2:r}))})()))}componentDidMount(){if(!this.svg)throw new Error("<svg> is not initialized");this.canActivate(this.props)&&(this.element=this.getElement(this.props),this.activateInitialEvents())}componentDidUpdate(e){e.draw!==this.props.draw&&(this.element&&(this.deactivateInitialEvents(),this.deactivateDrawEvents()),this.canActivate(this.props)&&(this.element=this.getElement(this.props),this.activateInitialEvents()))}componentWillUnmount(){this.element&&(this.deactivateInitialEvents(),this.deactivateDrawEvents())}}const l=Object(i.default)(u)`
  position: absolute;
  top: 0;
  left: 0;

  --color: rgb(255, 224, 0);
  --stroke-width: 4px;
  --fill-color: rgba(255, 224, 0, 0.2);

  > circle:first-child {
    stroke: var(--contour-drawer-color, var(--color));
    stroke-width: var(--contour-drawer-stroke-width, var(--stroke-width));
    fill: var(--contour-drawer-fill-color, var(--fill-color));
  }

  > circle[data-highlight] {
    stroke: #ffffff;
    stroke-width: var(--contour-drawer-stroke-width, var(--stroke-width));
    fill: transparent;
    ${c.a}
  }

  > line {
    stroke: var(--contour-drawer-color, var(--color));
    stroke-width: var(--contour-drawer-stroke-width, var(--stroke-width));
  }
`},715:function(e,t,n){"use strict";function r(e,t){return e.find(e=>{const[[n,r],[o,i]]=e.polygon,[s,a]=t,c=Math.sqrt(Math.pow(Math.abs(o-n),2)+Math.pow(Math.abs(i-r),2));return Math.sqrt(Math.pow(Math.abs(s-n),2)+Math.pow(Math.abs(a-r),2))<=c})||null}n.d(t,"a",(function(){return r}))},716:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),o=n.n(r),i=n(32),s=n(671),a=n(715);class c extends r.Component{constructor(e){super(e),this.svg=null,this.element=null,this.focused=null,this.contentWindow=window,this.svgRef=e=>{e&&this.svg&&this.element&&(this.deactivateInitialEvents(),this.canActivate(this.props)&&(this.svg=e,this.element=this.getElement(this.props),this.activateInitialEvents())),this.svg=e},this.getElement=({hover:e})=>e instanceof this.contentWindow.HTMLElement?e:this.svg,this.canActivate=({hover:e})=>e instanceof this.contentWindow.HTMLElement||!0===e,this.activateInitialEvents=()=>{this.element&&this.element.addEventListener("mousemove",this.onMouseMoveToFindFocus)},this.deactivateInitialEvents=()=>{this.element&&this.element.removeEventListener("mousemove",this.onMouseMoveToFindFocus)},this.onMouseMoveToFindFocus=e=>{this.findFocus(e.pageX,e.pageY)},this.findFocus=(e,t)=>{if(!this.props.contours||0===this.props.contours.length||!this.props.cornerstoneRenderData)return;const n=this.props.cornerstoneRenderData.element,{x:r,y:o}=cornerstone.pageToPixel(n,e,t);this.focused=Object(a.a)(this.props.contours,[r,o]),this.props.onFocus(this.focused)},this.state={p1:null,p2:null}}render(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.a,{stateRef:({contentWindow:e})=>this.contentWindow=e}),o.a.createElement("svg",{ref:this.svgRef,role:"figure",width:this.props.width,height:this.props.height,className:this.props.className}))}componentDidMount(){if(!this.svg)throw new Error("<svg> is not initialized");this.canActivate(this.props)&&(this.element=this.getElement(this.props),this.activateInitialEvents())}componentDidUpdate(e){e.hover!==this.props.hover&&(this.element&&this.deactivateInitialEvents(),this.canActivate(this.props)&&(this.element=this.getElement(this.props),this.activateInitialEvents()))}componentWillUnmount(){this.element&&this.deactivateInitialEvents()}}const u=Object(i.default)(c)`
  position: absolute;
  top: 0;
  left: 0;
`},717:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),o=n.n(r);function i({cornerstoneImage:e,width:t,height:n}){const i=Object(r.useRef)(null);return Object(r.useEffect)(()=>{const t=e.image.subscribe(e=>{if(i.current&&(cornerstone.disable(i.current),cornerstone.enable(i.current),e)){const t=cornerstone.getDefaultViewportForImage(i.current,e);cornerstone.displayImage(i.current,e,t)}});return()=>{t.unsubscribe()}},[e]),o.a.createElement("div",{ref:i,style:{width:t,height:n}})}},718:function(e,t,n){"use strict";n(0);n(32).default.div`
  display: inline-block;
  background-color: #000000;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center center;
`},719:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(653),o=n(641),i=n(646),s=n(664),a=n(645),c=n(657),u=n(663),l=n(88),h=n(0),d=n.n(h),p=n(32);function m({children:e,options:t}){const[n,r]=Object(h.useState)(()=>Array.isArray(t.width)?t.width[0]:t.width),[o,i]=Object(h.useState)(()=>Array.isArray(t.height)?t.height[0]:t.height),[s,a]=Object(h.useState)(()=>Array.isArray(t.control)?t.control[0]:t.control),[c,u]=Object(h.useState)(()=>Array.isArray(t.wheel)?t.wheel[0]:t.wheel),[l,p]=Object(h.useState)(()=>Array.isArray(t.invert)?t.invert[0]:t.invert),[m,v]=Object(h.useState)(()=>Array.isArray(t.flip)?t.flip[0]:t.flip),[f,w]=Object(h.useState)(Date.now()),b=Object(h.useMemo)(()=>({options:t,width:n,height:o,control:s,wheel:c,invert:l,flip:m,resetTime:f,updateWidth:r,updateHeight:i,updateControl:a,updateWheel:u,updateInvert:p,updateFlip:v,updateResetTime:w}),[t,n,o,s,c,l,m,f,r,i,a,u,p,v,w]);return d.a.createElement(h.Fragment,null,e(b),d.a.createElement(g,b))}function g({options:e,width:t,height:n,control:r,wheel:h,invert:p,flip:m,resetTime:g,updateWidth:f,updateHeight:w,updateControl:b,updateWheel:E,updateInvert:I,updateFlip:y,updateResetTime:x}){return d.a.createElement(v,null,Array.isArray(e.width)&&d.a.createElement(d.a.Fragment,null,d.a.createElement(l.a,{gutterBottom:!0},"Width"),d.a.createElement(u.a,{color:"primary",value:t,min:e.width[1],max:e.width[2],onChange:(e,t)=>f(t)})),Array.isArray(e.height)&&d.a.createElement(d.a.Fragment,null,d.a.createElement(l.a,{gutterBottom:!0},"Height"),d.a.createElement(u.a,{color:"primary",value:n,min:e.height[1],max:e.height[2],onChange:(e,t)=>w(t)})),Array.isArray(e.control)&&d.a.createElement(d.a.Fragment,null,d.a.createElement(l.a,{gutterBottom:!0},"Control"),d.a.createElement(s.a,{value:r,onChange:(e,t)=>b(t)},e.control[1].map(e=>d.a.createElement(a.a,{color:"primary",key:e,value:e,control:d.a.createElement(c.a,{color:"primary"}),label:e.toUpperCase()})))),Array.isArray(e.wheel)&&d.a.createElement(d.a.Fragment,null,d.a.createElement(l.a,{gutterBottom:!0},"Wheel"),d.a.createElement(s.a,{value:h,onChange:(e,t)=>E(t)},e.wheel[1].map(e=>d.a.createElement(a.a,{color:"primary",key:e,value:e,control:d.a.createElement(c.a,{color:"primary"}),label:e.toUpperCase()})))),Array.isArray(e.invert)&&d.a.createElement(d.a.Fragment,null,d.a.createElement(l.a,{gutterBottom:!0},"Invert"),d.a.createElement(i.a,{checked:p,color:"primary",onChange:(e,t)=>I(t)})),Array.isArray(e.flip)&&d.a.createElement(d.a.Fragment,null,d.a.createElement(l.a,{gutterBottom:!0},"Flip"),d.a.createElement(i.a,{checked:m,color:"primary",onChange:(e,t)=>y(t)})),d.a.createElement(l.a,{gutterBottom:!0},"Reset"),d.a.createElement(o.a,{variant:"contained",color:"primary",onClick:()=>x(Date.now())},"Reset"))}const v=Object(p.default)(r.a)`
  position: absolute;
  top: 10px;
  right: 10px;
  width: 200px;
`},720:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),o=n.n(r);function i({fontFamily:e="proximanova,noto_sanslight,sans-serif",fontSize:t=12,strokeWidth:n=6,strokeColor:i="#000000",children:s}){const[a,c]=Object(r.useState)(100),u=Object(r.useMemo)(()=>t+2*n,[t,n]),l=Object(r.useRef)(null),h=Object(r.useMemo)(()=>o.a.createElement(o.a.Fragment,null,Object(r.cloneElement)(s,{ref:l,x:n,y:n,stroke:i,strokeWidth:n,strokeLinejoin:"round",strokeLinecap:"round",dominantBaseline:"mathematical",fontFamily:e}),Object(r.cloneElement)(s,{x:n,y:n,dominantBaseline:"mathematical",fontFamily:e})),[s,e,i,n]);return Object(r.useLayoutEffect)(()=>{var e;const t=null===(e=l.current)||void 0===e?void 0:e.getBoundingClientRect();t&&c(t.width+2*n)},[n,h]),o.a.createElement("svg",{width:a,height:u,style:{pointerEvents:"none",userSelect:"none",fontSize:t}},h)}},721:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n.n(r),i=n(671);class s extends r.Component{constructor(...e){super(...e),this.element=void 0,this.currentViewport=null,this.currentImage=null,this.teardownInteraction=null,this.imageSubscription=null,this.needImageInitialize=!0,this.contentWindow=window,this.elementRef=e=>{this.element=e,e&&this.startInteraction(this.props.interactions)},this.initImage=e=>{cornerstone.disable(this.element),cornerstone.enable(this.element,{renderer:"webgl"});let t=this.getDefaultViewport(e,this.element);if(!t)throw new Error("defaultViewport\ub294 null\uc77c \uc218 \uc5c6\ub2e4.");if(Array.isArray(this.props.defaultViewportTransforms)){const e=t.scale;for(const n of this.props.defaultViewportTransforms){const r=n({element:this.element,currentViewport:t,minScale:e,maxScale:3});t={...t,...r}}}t={...t,hflip:this.props.flip,invert:this.props.invert},cornerstone.displayImage(this.element,e,t),this.setImage(e),this.setViewport(t),this.startInteraction(this.props.interactions)},this.subscribeImage=e=>{if(e)if(e.voiLUT=void 0,this.needImageInitialize)this.needImageInitialize=!1,this.initImage(e);else{if(!this.currentViewport)throw new Error("\uc5b4\ub5a4 \uc0c1\ud669\uc778\uc9c0 \ud655\uc778 \ud544\uc694!!!");cornerstone.displayImage(this.element,e,this.currentViewport)}},this.onImageRenderered=e=>{const t=e.detail;t&&t.canvasContext&&t.element&&t.enabledElement&&t.image&&"number"===typeof t.renderTimeInMs&&t.viewport?(this.currentViewport=t.viewport,this.props.updateCornerstoneRenderData(t)):console.error("CornerstoneEventData\uc5d0 \uc5c6\ub294 \uc815\ubcf4\uac00 \uc788\ub2e4???",t)},this.startInteraction=e=>{this.teardownInteraction&&this.teardownInteraction.forEach(e=>e()),this.teardownInteraction=e.filter(e=>"function"===typeof e).map(e=>e(this))},this.getElement=()=>this.element,this.getContentWindow=()=>this.contentWindow,this.getCurrentViewport=()=>this.currentViewport,this.getDefaultViewport=(e,t)=>e&&t?cornerstone.getDefaultViewportForImage(t,e):null,this.getMinScale=()=>{const e=this.getDefaultViewport(this.currentImage,this.element);if(!e)throw new Error("viewport\uac00 \uc815\uc0c1\uc801\uc73c\ub85c \uc640\uc57c\ub9cc \ud55c\ub2e4");return e.scale},this.getMaxScale=()=>3,this.updateViewport=e=>{this.currentViewport&&this.updateCurrentViewport(e)},this.getViewportTransformParams=()=>({element:this.element,minScale:this.getMinScale(),maxScale:this.getMaxScale(),currentViewport:this.currentViewport}),this.setCornerstoneImage=e=>{this.needImageInitialize=!0,this.setImage(null),this.imageSubscription&&(this.imageSubscription.unsubscribe(),this.imageSubscription=null),this.imageSubscription=e.image.subscribe(this.subscribeImage)},this.setImage=e=>{this.currentImage=e},this.setViewport=e=>{this.currentViewport=e,cornerstone.setViewport(this.element,this.currentViewport)},this.updateCurrentViewport=e=>{if(!this.currentViewport)throw new Error("viewport\uac00 \uc5c6\ub294 \uc0c1\ud0dc\uc5d0\uc11c \uc2e4\ud589\ub418\uba74 \uc548\ub41c\ub2e4");const t="function"===typeof e?e(this.currentViewport):e;this.currentViewport={...this.currentViewport,...t},cornerstone.setViewport(this.element,this.currentViewport)}}render(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.a,{stateRef:({contentWindow:e})=>this.contentWindow=e}),o.a.createElement("div",{ref:this.elementRef,style:{width:this.props.width,height:this.props.height}}))}componentDidMount(){this.element.addEventListener(cornerstone.EVENTS.IMAGE_RENDERED,this.onImageRenderered),this.setCornerstoneImage(this.props.image)}componentWillUnmount(){this.element.removeEventListener(cornerstone.EVENTS.IMAGE_RENDERED,this.onImageRenderered),cornerstone.disable(this.element),this.imageSubscription&&this.imageSubscription.unsubscribe(),this.teardownInteraction&&this.teardownInteraction.forEach(e=>e())}componentDidUpdate(e){const{width:t,height:n,flip:r,invert:o,interactions:i,resetTime:s,image:a}=this.props,c=this.getDefaultViewport(this.currentImage,this.element);if(e.interactions!==i&&this.startInteraction(i),c&&(e.resetTime!==s?this.updateCurrentViewport({...c,hflip:r,invert:c.invert?!o:o}):e.flip===r&&e.invert===o||this.updateCurrentViewport({hflip:r,invert:c.invert?!o:o})),(e.width!==t||e.height!==n)&&this.currentImage){cornerstone.resize(this.element);const e=cornerstone.getViewport(this.element);if(!e)throw new Error("getViewport() is returns not a Viewport");this.setViewport(e)}e.image!==a&&this.setCornerstoneImage(a)}}},722:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(703);const o=({element:e}={})=>({getElement:t,getCurrentViewport:n,updateViewport:o,getContentWindow:i})=>(e||(e=t()),Object(r.a)({element:e,getCurrentViewport:n,onMove:e=>o({voi:e}),onEnd:()=>{},contentWindow:i()}))},723:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(704);const o=({element:e}={})=>({getElement:t,getCurrentViewport:n,getContentWindow:o,updateViewport:i})=>(e||(e=t()),Object(r.a)({element:e,getCurrentViewport:n,onMove:e=>i({translation:e}),onEnd:()=>{},contentWindow:o()}))},724:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(705);const o=({element:e}={})=>({getElement:t,updateViewport:n,getCurrentViewport:o,getContentWindow:i,getMinScale:s,getMaxScale:a})=>(e||(e=t()),Object(r.a)({element:e,getMinMaxScale:()=>[s(),a()],getCurrentViewport:o,onZoom:e=>n(e),contentWindow:i()}))},725:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){const[t,n]=Object(r.useState)(()=>({current:e.getIndex(),end:e.length()-1}));return Object(r.useEffect)(()=>{const t=e.index.subscribe(t=>{n(n=>({...n,current:t,end:e.length()-1}))});return()=>{t.unsubscribe()}},[e]),t}},726:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o({image:e,element:t,enabled:n=!0}){Object(r.useEffect)(()=>{if(!t||!0!==n)return()=>{};function r(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),t.deltaY>0?e.prev():t.deltaY<0&&e.next()}return t.addEventListener("wheel",r),()=>{t.removeEventListener("wheel",r)}},[e,t,n])}},727:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(){const[e,t]=Object(r.useState)(null);return{cornerstoneRenderData:e,updateCornerstoneRenderData:t}}},728:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(744),o=n(729),i=n(0);function s({nextId:e,initialContours:t,mode:n="contour"}={}){const[s,c]=Object(i.useState)(()=>{if(t){const n="number"===typeof e?e:e&&"number"===typeof e.current?e.current:1;return t.map((e,t)=>({...e,id:n+t}))}return[]}),[u,l]=Object(i.useState)(null),h=Object(i.useCallback)((t,i={})=>{if("contour"===n&&(!Object(o.a)(t)||Object(r.a)(t)))return null;const{dataAttrs:s}=i;s&&a(s);let u=null;return c(n=>(u={...i,id:"number"===typeof e?e:e&&"number"===typeof e.current?e.current:Math.max(...n.map(({id:e})=>e),0)+1,polygon:t,dataAttrs:s},[...n,u])),u},[e,n]),d=Object(i.useCallback)(t=>{for(const e of t)e.dataAttrs&&a(e.dataAttrs);c(n=>{const r="number"===typeof e?e:e&&"number"===typeof e.current?e.current:Math.max(...n.map(({id:e})=>e),0)+1;return[...n,...t.map((e,t)=>({...e,id:r+t}))]})},[e]),p=Object(i.useCallback)((e,t)=>{if(t.polygon&&"contour"===n&&(!Object(o.a)(t.polygon)||Object(r.a)(t.polygon)))return;t.dataAttrs&&a(t.dataAttrs);const i={...e,...t,id:e.id};return c(t=>{const n=[...t],r=n.findIndex(({id:e})=>i.id===e);return r>-1&&(n[r]=i,l(t=>e===t?i:t)),n}),i},[n]),m=Object(i.useCallback)(e=>{l(t=>e!==t?e:t)},[]),g=Object(i.useCallback)(()=>{c([]),l(null)},[]);return{contours:s,addContour:h,addContours:d,updateContour:p,removeContour:Object(i.useCallback)(e=>{c(t=>{const n=t.findIndex(({id:t})=>t===e.id);if(n>-1){const e=[...t];return e.splice(n,1),e}return t}),l(null)},[]),removeAllContours:g,focusContour:m,focusedContour:u,reset:Object(i.useCallback)(({initialContours:t}={})=>{c(()=>{if(t){const n="number"===typeof e?e:e&&"number"===typeof e.current?e.current:1;return t.map((e,t)=>({...e,id:n+t}))}return[]})},[e])}}function a(e){e&&Object.keys(e).forEach(e=>{if(!/^data-/.test(e))throw new Error(`Contour.dataAttrs \uc18d\uc131\uc740 data-* \ud615\ud0dc\uc758 \uc774\ub984\uc73c\ub85c \uc785\ub825\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4 (${e})`)})}},729:function(e,t,n){"use strict";function r(e,t=100){let n=0;for(let r=0,o=e.length;r<o;r++){n+=e[r][0]*e[r===e.length-1?0:r+1][1]*.5,n-=e[r===e.length-1?0:r+1][0]*e[r][1]*.5}return Math.abs(n)>t}n.d(t,"a",(function(){return r}))},730:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(...e){const t=Object(r.useCallback)(({viewport:t})=>{const{hflip:n,vfilip:r,translation:o,scale:i}=t;for(const s of e)"updateViewport"in s?s.updateViewport({hflip:n,vfilip:r,translation:o,scale:i}):"current"in s&&s.current&&s.current.updateViewport({hflip:n,vfilip:r,translation:o,scale:i})},[...e]);return Object(r.useMemo)(()=>({updateMasterRenderData:t}),[t])}},731:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(654),i=n(647);function s(e){const[t,n]=Object(r.useState)(null);return Object(r.useEffect)(()=>{if(e){const t=Object(o.a)(e).pipe(Object(i.a)(e=>e.reduce((e,t)=>e+t,0)/e.length)).subscribe(e=>{e>=1&&(n(new Date),t.unsubscribe())});return()=>{t.unsubscribe()}}},[e]),t}},732:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(0),o=n.n(r),i=n(679);const s=Object(r.createContext)();function a(e){return new i.a(e)}function c({cacheImages:e=10,factory:t=a,children:n}){const[i]=Object(r.useState)(()=>[]),c=Object(r.useCallback)(n=>{let r=i.find(([e])=>e===n);if(!r&&(r=[n,t(n)],i.push(r),i.length>e)){const t=i.length-e,n=i.splice(0,t);for(const e of n)e[1].destroy()}return r[1]},[i,e,t]),u=Object(r.useCallback)(e=>{const t=i.findIndex(([t])=>t===e);if(t>-1){const e=i.splice(t,1);for(const t of e)t[1].destroy()}},[i]);return Object(r.useEffect)(()=>()=>{for(const e of i)e[1].destroy()},[i]),o.a.createElement(s.Provider,{value:{fetch:c,purge:u}},n)}function u(){return Object(r.useContext)(s)}s.Consumer},733:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,n,r={},o={})=>{const{cornerstone:i}=cornerstoneWADOImageLoader.external,s=new XMLHttpRequest;return new Promise((a,c)=>{s.open("get",t,!0),s.responseType="arraybuffer",Object.keys(r).forEach(e=>{s.setRequestHeader(e,r[e])}),o.deferred={resolve:a,reject:c},o.url=t,o.imageId=n,"function"===typeof e&&e((function(){try{s.abort()}catch(e){}})),s.onreadystatechange=()=>{4===s.readyState&&200===s.status&&a(s.response)},s.onloadstart=()=>{const e={url:t,imageId:n};i&&i.triggerEvent(i.events,"cornerstoneimageloadstart",e)},s.onloadend=()=>{const e={url:t,imageId:n};i.triggerEvent(i.events,"cornerstoneimageloadend",e)},s.onprogress=({loaded:e,lengthComputable:r,total:o})=>{let s;r&&(s=Math.round(e/o*100));const a={url:t,imageId:n,loaded:e,total:o,percentComplete:s};i.triggerEvent(i.events,"cornerstoneimageloadprogress",a)},s.send()})}},734:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(659),o=n(647),i=n(675),s=n(676),a=n(733);function c(e){return null!==e}const u=new i.a;class l{constructor(e,t={}){this.imageIds=e,this.options=t,this._images=void 0,this._imageSubject=void 0,this._progressSubject=void 0,this._indexSubject=void 0,this._cancel=[],this._loader=void 0,this._destoyed=!1,this.onProgress=e=>{const t=Object(s.a)(e);if(t){const e=this.imageIds.indexOf(t.imageId);if(e>-1){const n=[...this._progressSubject.getValue()];n[e]=t.loaded/t.total,this._progressSubject.next(n)}}},this.destroy=()=>{this.options&&"function"===typeof this.options.unload&&this.options.unload(this.imageIds),this._imageSubject.unsubscribe(),cornerstone.events.removeEventListener("cornerstoneimageloadprogress",this.onProgress),this._cancel.forEach(e=>e()),this._destoyed=!0},this.length=()=>this._images.length,this.getIndex=()=>this._indexSubject.getValue(),this.goto=e=>{this.change(Math.max(0,Math.min(this._images.length-1,e)))},this.next=(e=1)=>{this.change(Math.min(this._images.length-1,this._indexSubject.getValue()+e))},this.prev=(e=1)=>{this.change(Math.max(0,this._indexSubject.getValue()-e))},this.change=e=>{if(this._indexSubject.next(e),this._images[e])return void this._imageSubject.next(this._images[e]);const t=this._images.slice(0,e-1).filter(c).reverse();if(t.length>0)return void this._imageSubject.next(t[0]);const n=this._images.slice(e+1).filter(c);n.length>0?this._imageSubject.next(n[0]):console.warn("\ub300\uccb4\ud560 Image\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc74c")},this.loadImage=async(e,t)=>{try{this._images[t]=await this._loader.loadImage({imageId:e,options:{loader:Object(a.a)(e=>this._cancel.push(e))}});const n=[...this._progressSubject.getValue()];n[t]=1,n.reduce((e,t)=>e+t,0)>=1&&cornerstone.events.removeEventListener("cornerstoneimageloadprogress",this.onProgress),this._destoyed||this._progressSubject.next(n)}catch(n){this._destoyed||(console.warn(`It will retry loadImage(${e}):`,n),this.loadImage(e,t))}},this._images=e.map(()=>null);const{initialIndex:n=0}=t;this._imageSubject=new r.a(null),this._indexSubject=new r.a(n),this._progressSubject=new r.a(e.map(()=>0)),this._loader=t.loader||u,cornerstone.events.addEventListener("cornerstoneimageloadprogress",this.onProgress),this.loadImage(e[n],n).then(()=>{this.change(this._indexSubject.getValue()),e.forEach((e,t)=>{t!==n&&this.loadImage(e,t).then(()=>{t===this._indexSubject.getValue()&&this.change(this._indexSubject.getValue())})})})}get image(){return this._imageSubject.asObservable()}get progress(){return this._progressSubject.pipe(Object(o.a)(e=>e.reduce((e,t)=>e+t,0)/e.length))}get index(){return this._indexSubject.asObservable()}}},735:function(e,t,n){"use strict"},736:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(659);function o({url:e,signal:t,headers:n}){const o=new r.a(0),i=new XMLHttpRequest;if(i.open("get",e,!0),i.responseType="arraybuffer",n instanceof Headers||Array.isArray(n))for(const[r,a]of n)i.setRequestHeader(r,a);else n&&Object.keys(n).forEach(e=>{i.setRequestHeader(e,n[e])});const s=()=>{try{i.abort()}catch(e){}null===t||void 0===t||t.removeEventListener("abort",s)};return null===t||void 0===t||t.addEventListener("abort",s),i.onloadstart=()=>{o.next(0)},i.onreadystatechange=()=>{4===i.readyState&&200===i.status&&(o.next(i.response),null===t||void 0===t||t.removeEventListener("abort",s))},i.onprogress=({loaded:e,lengthComputable:t,total:n})=>{t&&o.next(e/n)},i.send(),o.asObservable()}},737:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(659);function o({blob:e,signal:t}){const n=new r.a(0),o=new FileReader,i=()=>{try{o.abort()}catch(e){}null===t||void 0===t||t.removeEventListener("abort",i)};return null===t||void 0===t||t.addEventListener("abort",i),o.onloadstart=()=>{n.next(0)},o.onloadend=()=>{n.next(o.result),null===t||void 0===t||t.removeEventListener("abort",i)},o.onprogress=({loaded:e,lengthComputable:t,total:r})=>{t&&n.next(e/r)},o.readAsArrayBuffer(e),n.asObservable()}},738:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(659),o=n(647);const i=new(n(675).a);class s{constructor(e,t={}){this.file=e,this.options=t,this._imageSubject=void 0,this._imageId=void 0,this._loader=void 0,this._destoyed=!1,this.destroy=()=>{this.options&&"function"===typeof this.options.unload&&this.options.unload(this._imageId),this._destoyed=!0},this.loadImage=async()=>{try{const e=await this._loader.loadImage({imageId:this._imageId});this._destoyed||this._imageSubject.next(e)}catch(e){this._destoyed||(console.warn(`It will retry loadImage(${this._imageId}):`,e),this.loadImage())}},this._imageSubject=new r.a(null),this._loader=t.loader||i,this._imageId=cornerstoneWADOImageLoader.wadouri.fileManager.add(e),this.loadImage()}get image(){return this._imageSubject.asObservable()}get progress(){return this._imageSubject.pipe(Object(o.a)(e=>e?1:0))}}},739:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(659);class o{constructor({progress:e,images:t,initialIndex:n="center"}){this._imageSubject=void 0,this._indexSubject=void 0,this._imagesSubscription=void 0,this._progress=void 0,this._images=null,this.length=()=>{var e;return(null===(e=this._images)||void 0===e?void 0:e.length)||0},this.getIndex=()=>this._indexSubject.getValue(),this.goto=e=>{if(!this._images)return;const t=Math.max(0,Math.min(this._images.length-1,e));this._imageSubject.next(this._images[t]),this._indexSubject.next(t)},this.next=(e=1)=>{if(!this._images)return;const t=Math.min(this._images.length-1,this._indexSubject.getValue()+e);this._imageSubject.next(this._images[t]),this._indexSubject.next(t)},this.prev=(e=1)=>{if(!this._images)return;const t=Math.max(0,this._indexSubject.getValue()-e);this._imageSubject.next(this._images[t]),this._indexSubject.next(t)},this.destroy=()=>{this._imagesSubscription.unsubscribe(),this._imageSubject.unsubscribe(),this._indexSubject.unsubscribe()},this._imagesSubscription=t.subscribe(e=>{let t;this._images=e,t="start"===n?0:"center"===n?Math.round(e.length/2):"end"===n?e.length-1:n,this._imageSubject.next(e[t]),this._indexSubject.next(t),this._imagesSubscription.unsubscribe()}),this._progress=e,this._imageSubject=new r.a(null),this._indexSubject=new r.a(0)}get image(){return this._imageSubject.asObservable()}get progress(){return this._progress}get index(){return this._indexSubject.asObservable()}}},740:function(e,t,n){"use strict"},741:function(e,t,n){"use strict";n(0);var r=n(32),o=n(680);r.createGlobalStyle`
  html {
    font-size: 14px;
    box-sizing: border-box;
  }
  
  ${o.b}
`},743:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(674),o=n(0),i=n.n(o);class s extends o.Component{constructor(...e){super(...e),this.canvasRef=Object(o.createRef)(),this.ctx=null,this.imageData=null,this.imageResourceCanvas=null,this.drawHeatmap=({cornerstoneRenderData:e})=>{if(this.imageData&&this.imageResourceCanvas&&this.ctx&&e)try{this.ctx.save(),this.imageResourceCanvas.width=this.imageData.width,this.imageResourceCanvas.height=this.imageData.height,this.imageResourceCanvas.getContext("2d").putImageData(this.imageData,0,0),cornerstone.setToPixelCoordinateSystem(e.enabledElement,this.ctx);const t=e.image.width,n=e.image.height;this.ctx.drawImage(this.imageResourceCanvas,0,0,this.imageResourceCanvas.width,this.imageResourceCanvas.height,0,0,t,n),this.ctx.restore()}catch(t){console.error(t)}}}render(){return i.a.createElement(a,{ref:this.canvasRef,width:this.props.width,height:this.props.height,style:{width:this.props.width,height:this.props.height}})}componentDidMount(){if(this.imageResourceCanvas=document.createElement("canvas"),!this.canvasRef.current)throw new Error("<canvas> is not initialized");if(this.ctx=this.canvasRef.current.getContext("2d"),!this.ctx)throw new Error("<canvas> context 2d is not initialized");this.imageData=Object(r.b)(this.props.posMap,this.props.threshold),this.drawHeatmap(this.props)}componentDidUpdate(e){const{width:t,height:n,posMap:o,threshold:i,cornerstoneRenderData:s}=this.props;e.posMap===o&&e.threshold===i||(this.imageData=Object(r.b)(o,i)),e.posMap===o&&e.threshold===i&&e.cornerstoneRenderData===s||(!function(e,t,n){e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t,n),e.restore()}(this.ctx,t,n),this.drawHeatmap(this.props))}}const a=n(32).default.canvas`
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none;
`},744:function(e,t,n){"use strict";function r(e,t,n,r){if(Math.max(e[0],t[0])<=Math.min(n[0],r[0]))return!1;if(Math.min(e[0],t[0])>=Math.max(n[0],r[0]))return!1;if(Math.max(e[1],t[1])<=Math.min(n[1],r[1]))return!1;if(Math.min(e[1],t[1])>=Math.max(n[1],r[1]))return!1;const o=(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1]),i=(t[0]-e[0])*(r[1]-e[1])-(r[0]-e[0])*(t[1]-e[1]),s=(r[0]-n[0])*(e[1]-n[1])-(e[0]-n[0])*(r[1]-n[1]),a=(r[0]-n[0])*(t[1]-n[1])-(t[0]-n[0])*(r[1]-n[1]);return 0===o&&0===i&&0===s&&0===a||o*i<0&&s*a<0}function o(e){const t=[...e,e[0]],n=t.length;let o=-1;for(;++o<n-2;){let e=o+2;for(;++e<n-1;)if(r(t[o],t[o+1],t[e],t[e+1]))return!0}return!1}n.d(t,"a",(function(){return o}))},745:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(35);function o(e){const t=new Uint8Array(e);return String.fromCharCode.apply(null,t)}function i(e){if("NUMPY"!==o(e.slice(0,6)).slice(1,6))throw new Error("unknown file type");let t,n=function(e){let t=new DataView(e),n=t.getUint8(0);return n|=t.getUint8(1)<<8,n}(e.slice(8,10)),r=10+n,i=o(e.slice(10,10+n)).toLowerCase().replace(/\(/g,"[").replace(/\)/g,"]").replace(/'/g,'"').replace(", }","}"),s=JSON.parse(i);if("|u1"===s.descr)t=new Uint8Array(e,r);else if("|i1"===s.descr)t=new Int8Array(e,r);else if("<u2"===s.descr)t=new Uint16Array(e,r);else if("<i2"===s.descr)t=new Int16Array(e,r);else if("<u4"===s.descr)t=new Uint32Array(e,r);else if("<i4"===s.descr)t=new Int32Array(e,r);else if("<f4"===s.descr)t=new Float32Array(e,r);else{if("<f8"!==s.descr)throw new Error("unknown numeric dtype");t=new Float64Array(e,r)}return{shape:s.shape,isFortranOrder:s.fortran_order,data:t}}const s=({id:e,windowCenter:t,windowWidth:n,sliceSpacing:o,rowPixelSpacing:s,columnPixelSpacing:a,slope:c=1,intercept:u=0,minPixelValue:l=-2048,maxPixelValue:h=3096})=>d=>new r.a(r=>{const p=d.subscribe(d=>{const{shape:[,m,g,v],data:f}=i(d),w=[],b=[],E=[],I=v*g;for(let r=0;r<m;r++){const i=new Int16Array(I);for(let e=0;e<I;e++)i[e]=f[r*I+e];w.push({imageId:e+"_axial_"+r,minPixelValue:l,maxPixelValue:h,slope:c,intercept:u,windowCenter:t,windowWidth:n,getPixelData:()=>i,rows:g,columns:v,height:g,width:v,color:!1,columnPixelSpacing:a,rowPixelSpacing:s,invert:!1,sizeInBytes:v*g*Int16Array.BYTES_PER_ELEMENT,sliceSpacing:o})}const y=m,x=v;for(let r=0;r<g;r++){const i=new Int16Array(y*x);for(let e=0;e<x;e++)for(let t=0;t<y;t++)i[e+(y-t-1)*x]=f[e+t*I+r*x];b.push({imageId:e+"_coronal_"+r,minPixelValue:l,maxPixelValue:h,slope:c,intercept:u,windowCenter:t,windowWidth:n,getPixelData:()=>i,rows:y,columns:x,height:y,width:x,color:!1,columnPixelSpacing:a,rowPixelSpacing:o,invert:!1,sizeInBytes:y*x*Int16Array.BYTES_PER_ELEMENT,sliceSpacing:s});const d=m,p=g,w=new Int16Array(d*p);for(let e=0;e<p;e++)for(let t=0;t<d;t++)w[e+(d-t-1)*p]=f[e*v+t*I+r];E.push({imageId:e+"_sagittal_"+r,minPixelValue:l,maxPixelValue:h,slope:c,intercept:u,windowCenter:t,windowWidth:n,getPixelData:()=>w,rows:d,columns:p,height:d,width:p,color:!1,columnPixelSpacing:s,rowPixelSpacing:o,invert:!1,sizeInBytes:d*p*Int16Array.BYTES_PER_ELEMENT,sliceSpacing:a})}return r.next({axial:w,coronal:b,sagittal:E}),()=>{p.unsubscribe()}},e=>r.error(e),()=>r.complete())})},746:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n.n(r),i=n(32);const s=Object(i.default)((function({x:e,y:t,label:n,onEnter:i,onLeave:s,onRemove:a,...c}){const u=Object(r.useCallback)(e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),e.preventDefault(),a()},[a]);return o.a.createElement("g",Object.assign({},c,{transform:`translate(${e} ${t})`,onMouseEnter:i,onMouseLeave:s,onClick:u}),o.a.createElement("circle",{cx:0,cy:0,r:4}),o.a.createElement("path",{d:"M8,16c0,0,6-5.582,6-10s-2.686-6-6-6S2,1.582,2,6S8,16,8,16z M5,5c0-1.657,1.343-3,3-3s3,1.343,3,3S9.657,8,8,8S5,6.657,5,5  z",transform:"translate(-8 -16)","data-border":"border"}),o.a.createElement("path",{d:"M8,16c0,0,6-5.582,6-10s-2.686-6-6-6S2,1.582,2,6S8,16,8,16z M5,5c0-1.657,1.343-3,3-3s3,1.343,3,3S9.657,8,8,8S5,6.657,5,5  z",transform:"translate(-8 -16)"}),n&&o.a.createElement("g",{transform:"translate(0 -25)"},o.a.createElement("text",null,n),o.a.createElement("text",null,n)))}))`
  cursor: pointer;

  color: var(--pin-color, #ffffff);

  &[data-focused] {
    color: var(--pin-focused-color, rgb(255, 194, 17));
  }

  > circle {
    fill: #000000;
  }

  > path {
    fill: currentColor;

    &[data-border] {
      stroke-width: 4px;
      stroke: #000000;
    }
  }

  > g {
    text {
      text-anchor: middle;
      font-size: 14px;
      font-weight: bold;
    }

    text:first-child {
      stroke-width: 4px;
      stroke: #000000;
    }

    text:last-child {
      fill: currentColor;
    }
  }
`;class a extends r.Component{constructor(...e){super(...e),this.onPointAdd=e=>{if("function"===typeof this.props.onAdd&&this.props.cornerstoneRenderData&&this.props.cornerstoneRenderData.element){const t=this.props.cornerstoneRenderData.element,{x:n,y:r}=cornerstone.pageToPixel(t,e.pageX,e.pageY);this.props.onAdd([[n,r]],e)}},this.onPointEnter=e=>{"function"===typeof this.props.onFocus&&this.props.onFocus(e)},this.onPointLeave=()=>{"function"===typeof this.props.onFocus&&this.props.onFocus(null)},this.onPointRemove=e=>{"function"===typeof this.props.onRemove&&this.props.onRemove(e)}}render(){return o.a.createElement("svg",{role:"figure",width:this.props.width,height:this.props.height,className:this.props.className,style:{position:"absolute",top:0,left:0,width:this.props.width,height:this.props.height,userSelect:"none",pointerEvents:!0===this.props.interact?"auto":"none"},onClick:this.onPointAdd},this.props.cornerstoneRenderData&&this.props.contours&&this.props.contours.length>0&&this.props.contours.map(e=>{const{id:t,polygon:n,dataAttrs:r={},label:i}=e,a="function"===typeof this.props.pointPinFunction?this.props.pointPinFunction(e):this.props.pointPinComponent||s,c="function"===typeof i?i(e):"string"===typeof i?i:t.toString();return o.a.createElement(a,Object.assign({key:t},(u=this.props.cornerstoneRenderData.element,l=n[0],cornerstone.pixelToCanvas(u,{x:l[0],y:l[1]})),r,{"data-id":t,"data-focused":e===this.props.focusedContour||void 0,label:c,onEnter:()=>this.onPointEnter(e),onLeave:()=>this.onPointLeave(),onRemove:()=>this.onPointRemove(e)}));var u,l}))}}}}]);
//# sourceMappingURL=1.9d62a9d3aaef776b5d0e.js.map
{"version":3,"sources":["webpack:///./src/_packages/@lunit/heatmap/draw/getRGBArray.ts","webpack:///./src/_packages/@lunit/heatmap/draw/getRGBAArray.ts","webpack:///./src/_packages/@lunit/heatmap/draw/getAlpha.ts","webpack:///./src/_packages/@lunit/heatmap/hooks/useHeatmapScaleImageURI.ts","webpack:///./src/_packages/@lunit/heatmap/components/HeatmapScaleSVGImage.tsx","webpack:///./src/_packages/@lunit/heatmap/draw/posMapToImageData.ts","webpack:///./src/_packages/@lunit/heatmap/__pages__/Samples/posMapToImageDataPreview.png","webpack:///./src/_packages/@lunit/heatmap/draw/posMapToImageData.ts?b5db","webpack:///./src/_packages/@lunit/heatmap/__pages__/Samples/posMapImageData.tsx","webpack:///./src/_packages/@lunit/heatmap/__pages__/Samples/posMapImageData.tsx?9eb7","webpack:///./src/_packages/@lunit/heatmap/__pages__/PosMapRendering.mdx"],"names":["getRGBArray","value","r","g","b","v","Math","max","min","getRGBAArray","stop","threshold","alpha","getAlpha","useHeatmapScaleImageURI","width","height","useMemo","canvas","document","createElement","ratio","window","devicePixelRatio","w","h","setAttribute","toString","ctx","getContext","i","beginPath","fillStyle","fillRect","closePath","toDataURL","HeatmapScaleSVGImage","imageProps","dataUri","xlinkHref","posMapToImageData","posMap","length","imageData","createImageData","imageDataRgbaMap","data","y","x","pos","module","exports","canvasRef","useRef","engine_result","pos_map","useEffect","current","Error","putImageData","ref","style","layoutProps","MDXContent","components","props","mdxType","parentName","example","source","api","src","posMapToImageDataPreview","maxWidth","component","isMDXComponent"],"mappings":"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","file":"12.4be4349ff7474e74e988.js","sourcesContent":["export function getRGBArray(value: number): [number, number, number] {\n  let r: number, g: number, b: number;\n  const v: number = Math.max(Math.min(value, 1), 0);\n\n  if (v < 0.25) {\n    r = 0;\n    g = 4 * v;\n    b = 1;\n  } else if (v < 0.5) {\n    r = 0;\n    g = 1;\n    b = 1 + 4 * (0.25 - v);\n  } else if (v < 0.75) {\n    r = 4 * (v - 0.5);\n    g = 1;\n    b = 0;\n  } else {\n    r = 1;\n    g = 1 + 4 * (0.75 - v);\n    b = 0;\n  }\n\n  return [(r * 255) << 0, (g * 255) << 0, (b * 255) << 0];\n}\n","import { getAlpha } from './getAlpha';\nimport { getRGBArray } from './getRGBArray';\n\nexport function getRGBAArray({\n  stop,\n  threshold,\n}: {\n  stop: number;\n  threshold: number;\n}): [number, number, number, number] {\n  const alpha: number = getAlpha({ stop, threshold });\n\n  if (alpha <= 0) return [0, 0, 0, 0];\n\n  const [r, g, b] = getRGBArray(stop);\n\n  return [r, g, b, alpha];\n}\n","export function getAlpha({ stop, threshold }: { stop: number; threshold: number }): number {\n  return stop < threshold ? 0 : ((stop - threshold) * 0.75) / (1 - threshold);\n}\n","import { useMemo } from 'react';\nimport { getRGBAArray } from '../draw/getRGBAArray';\n\ninterface UseHeatmapScaleImageURIParameters {\n  width: number;\n  height: number;\n  threshold: number;\n}\n\n/**\n * `width x height` 사이즈의 Reactangle Image를 만들어준다. Image는 Data URI 형태로 전달되기 때문에 `<img src={uri}/>`나 `<image xlink:href={uri}/>`로 사용할 수 있다.\n */\nexport function useHeatmapScaleImageURI({\n  width,\n  height,\n  threshold,\n}: UseHeatmapScaleImageURIParameters): string | null {\n  return useMemo<string | null>(() => {\n    const canvas: HTMLCanvasElement | null = document.createElement('canvas');\n    if (!canvas) return null;\n\n    const ratio: number = window.devicePixelRatio;\n    const w: number = width * ratio;\n    const h: number = height * ratio;\n\n    canvas.setAttribute('width', w.toString());\n    canvas.setAttribute('height', h.toString());\n\n    const ctx: CanvasRenderingContext2D | null = canvas.getContext('2d');\n    if (!ctx) return null;\n\n    let i: number = w + 1;\n    while (--i >= 0) {\n      ctx.beginPath();\n      ctx.fillStyle = `rgba(${getRGBAArray({ stop: i / w, threshold })})`;\n      ctx.fillRect(i, 0, 1, h);\n      ctx.closePath();\n    }\n\n    return canvas.toDataURL();\n  }, [threshold, width, height]);\n}\n","import React, { SVGProps } from 'react';\nimport { useHeatmapScaleImageURI } from '../hooks/useHeatmapScaleImageURI';\n\nexport interface HeatmapScaleImageProps extends SVGProps<SVGImageElement> {\n  threshold?: number;\n  width: number;\n  height: number;\n}\n\n/**\n * `width x height` 형태의 Rectangle SVG <image/>. <svg> 내에서 사용할 수 있다.\n */\nexport function HeatmapScaleSVGImage({ threshold = 0, width, height, ...imageProps }: HeatmapScaleImageProps) {\n  const dataUri: string | null = useHeatmapScaleImageURI({ width, height, threshold });\n\n  return dataUri ? <image {...imageProps} xlinkHref={dataUri} width={width} height={height} /> : null;\n}\n","import { getRGBArray } from './getRGBArray';\n\n/**\n * posMap data를 ImageData 객체로 변환한다\n *\n * threshold는 보통 CXR=0.15 MMG=0.1 (개별 프로젝트에 따라 확인 필요)\n */\nexport function posMapToImageData(posMap: number[][], threshold: number): ImageData {\n  const width: number = posMap[0].length;\n  const height: number = posMap.length;\n  const canvas: HTMLCanvasElement = document.createElement('canvas');\n  const ctx: CanvasRenderingContext2D = canvas.getContext('2d')!;\n  const imageData: ImageData = ctx!.createImageData(width, height);\n  // [r, g, b, a, r, g, b, a, ...]\n  const imageDataRgbaMap: Uint8ClampedArray = imageData.data;\n\n  let y: number = -1;\n  while (++y < height) {\n    let x: number = -1;\n    while (++x < width) {\n      // rgba array index position\n      const pos: number = (y * width + x) * 4;\n      const stop: number = posMap[y][x];\n\n      if (stop < threshold) {\n        imageDataRgbaMap[pos] = 0;\n        imageDataRgbaMap[pos + 1] = 0;\n        imageDataRgbaMap[pos + 2] = 0;\n        imageDataRgbaMap[pos + 3] = 0;\n      } else {\n        // eg. threshold = 0.1 / stop = 0.3\n        // <threshold를 제외한 stop 값>(0.3 - 0.1) / <threshold를 제외한 max 값>(1 - 0.1)\n        // 0.2 / 0.9 = 0.222222222\n        const value: number = (stop - threshold) / (1 - threshold);\n        const [r, g, b] = getRGBArray(value);\n        imageDataRgbaMap[pos] = r;\n        imageDataRgbaMap[pos + 1] = g;\n        imageDataRgbaMap[pos + 2] = b;\n        imageDataRgbaMap[pos + 3] = (value * 196) << 0;\n      }\n    }\n  }\n\n  return imageData;\n}\n","module.exports = __webpack_public_path__ + \"posMapToImageDataPreview.dbafc7ec9d542ca5088c45a917e2efbd.png\";","export default \"import { getRGBArray } from './getRGBArray';\\n\\n/**\\n * posMap data를 ImageData 객체로 변환한다\\n *\\n * threshold는 보통 CXR=0.15 MMG=0.1 (개별 프로젝트에 따라 확인 필요)\\n */\\nexport function posMapToImageData(posMap: number[][], threshold: number): ImageData {\\n  const width: number = posMap[0].length;\\n  const height: number = posMap.length;\\n  const canvas: HTMLCanvasElement = document.createElement('canvas');\\n  const ctx: CanvasRenderingContext2D = canvas.getContext('2d')!;\\n  const imageData: ImageData = ctx!.createImageData(width, height);\\n  // [r, g, b, a, r, g, b, a, ...]\\n  const imageDataRgbaMap: Uint8ClampedArray = imageData.data;\\n\\n  let y: number = -1;\\n  while (++y < height) {\\n    let x: number = -1;\\n    while (++x < width) {\\n      // rgba array index position\\n      const pos: number = (y * width + x) * 4;\\n      const stop: number = posMap[y][x];\\n\\n      if (stop < threshold) {\\n        imageDataRgbaMap[pos] = 0;\\n        imageDataRgbaMap[pos + 1] = 0;\\n        imageDataRgbaMap[pos + 2] = 0;\\n        imageDataRgbaMap[pos + 3] = 0;\\n      } else {\\n        // eg. threshold = 0.1 / stop = 0.3\\n        // <threshold를 제외한 stop 값>(0.3 - 0.1) / <threshold를 제외한 max 값>(1 - 0.1)\\n        // 0.2 / 0.9 = 0.222222222\\n        const value: number = (stop - threshold) / (1 - threshold);\\n        const [r, g, b] = getRGBArray(value);\\n        imageDataRgbaMap[pos] = r;\\n        imageDataRgbaMap[pos + 1] = g;\\n        imageDataRgbaMap[pos + 2] = b;\\n        imageDataRgbaMap[pos + 3] = (value * 196) << 0;\\n      }\\n    }\\n  }\\n\\n  return imageData;\\n}\\n\"","import { posMapToImageData } from '@lunit/heatmap';\nimport React, { MutableRefObject, useEffect, useMemo, useRef } from 'react';\nimport data from './posMap.sample.json';\n\nexport default () => {\n  const canvasRef: MutableRefObject<HTMLCanvasElement | null> = useRef<HTMLCanvasElement | null>(null);\n\n  // AI에서 나온 posMap 결과를 ImageData로 변환한다\n  const imageData = useMemo<ImageData>(() => {\n    return posMapToImageData(data.engine_result.engine_result.pos_map, 0.1);\n  }, []);\n\n  useEffect(() => {\n    if (!canvasRef.current) throw new Error('<canvas> is null');\n\n    const ctx: CanvasRenderingContext2D | null = canvasRef.current.getContext('2d');\n\n    if (!ctx) throw new Error('ctx is null');\n\n    // ImageData를 Canvas Context에 그린다\n    ctx.putImageData(imageData, 0, 0);\n  }, [imageData]);\n\n  return (\n    <canvas\n      ref={canvasRef}\n      width={imageData.width}\n      height={imageData.height}\n      style={{\n        width: imageData.width,\n        height: imageData.height,\n      }}\n    />\n  );\n};\n","export default \"import { posMapToImageData } from '@lunit/heatmap';\\nimport React, { MutableRefObject, useEffect, useMemo, useRef } from 'react';\\nimport data from './posMap.sample.json';\\n\\nexport default () => {\\n  const canvasRef: MutableRefObject<HTMLCanvasElement | null> = useRef<HTMLCanvasElement | null>(null);\\n\\n  // AI에서 나온 posMap 결과를 ImageData로 변환한다\\n  const imageData = useMemo<ImageData>(() => {\\n    return posMapToImageData(data.engine_result.engine_result.pos_map, 0.1);\\n  }, []);\\n\\n  useEffect(() => {\\n    if (!canvasRef.current) throw new Error('<canvas> is null');\\n\\n    const ctx: CanvasRenderingContext2D | null = canvasRef.current.getContext('2d');\\n\\n    if (!ctx) throw new Error('ctx is null');\\n\\n    // ImageData를 Canvas Context에 그린다\\n    ctx.putImageData(imageData, 0, 0);\\n  }, [imageData]);\\n\\n  return (\\n    <canvas\\n      ref={canvasRef}\\n      width={imageData.width}\\n      height={imageData.height}\\n      style={{\\n        width: imageData.width,\\n        height: imageData.height,\\n      }}\\n    />\\n  );\\n};\\n\"","\nimport React from 'react'\nimport { mdx } from '@mdx-js/react'\n\n/* @jsx mdx */\nimport { component, source } from '@handbook/source';\nimport { Example, Preview } from '@handbook/components';\nimport posMapToImageDataPreview from './Samples/posMapToImageDataPreview.png';\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  \n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n    <h1><inlineCode parentName=\"h1\">{`posMapToImageData()`}</inlineCode></h1>\n    <p><inlineCode parentName=\"p\">{`number[][]`}</inlineCode>{` 형태의 Posmap Data를 Canvas Drawing에 사용할 수 있는 `}<inlineCode parentName=\"p\">{`ImageData`}</inlineCode>{`로 변환한다.`}</p>\n    <Example example={source('../draw/posMapToImageData')} api mdxType=\"Example\" />\n    <img src={posMapToImageDataPreview} style={{\n      maxWidth: 400\n    }} />\n    <p><inlineCode parentName=\"p\">{`<HeatmapViewer>`}</inlineCode>{`에서 사용된다.`}</p>\n    <Example example={component('./Samples/posMapImageData')} mdxType=\"Example\">\n  <Preview height={320} mdxType=\"Preview\" />\n    </Example>\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"],"sourceRoot":""}
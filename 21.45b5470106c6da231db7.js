(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{668:function(e){e.exports=JSON.parse('["CT000000.dcm","CT000001.dcm","CT000002.dcm","CT000003.dcm","CT000004.dcm","CT000005.dcm","CT000006.dcm","CT000007.dcm","CT000008.dcm","CT000009.dcm","CT000010.dcm","CT000011.dcm","CT000012.dcm","CT000013.dcm","CT000014.dcm","CT000015.dcm","CT000016.dcm","CT000017.dcm","CT000018.dcm","CT000019.dcm","CT000020.dcm","CT000021.dcm","CT000022.dcm","CT000023.dcm","CT000024.dcm","CT000025.dcm","CT000026.dcm","CT000027.dcm","CT000028.dcm","CT000029.dcm","CT000030.dcm"]')},845:function(e,n,t){"use strict";t.r(n),n.default="import { CornerstoneSequenceImage } from '@lunit/insight-viewer';\nimport { isTouchDevice } from '@lunit/is-touch-device';\nimport { useEffect } from 'react';\n\ninterface SeriesImageScrollParams {\n  image: CornerstoneSequenceImage;\n\n  /** Wheel Event\ub97c \ucc98\ub9ac\ud560 EventTarget */\n  element: HTMLElement | null;\n\n  /** User Interaction \ud65c\uc131\ud654 \uc5ec\ubd80 */\n  enabled?: boolean;\n\n  /** Touch Direction */\n  touchDirection?: 'horizontal' | 'vertical';\n}\n\nexport function useSeriesImageScroll({\n  image,\n  element,\n  enabled = true,\n  touchDirection = 'vertical',\n}: SeriesImageScrollParams) {\n  useEffect(() => {\n    if (!element || enabled !== true) {\n      return () => {};\n    }\n\n    // ---------------------------------------------\n    // wheel handler\n    // ---------------------------------------------\n    function wheel(event: WheelEvent) {\n      event.preventDefault();\n      event.stopPropagation();\n      event.stopImmediatePropagation();\n\n      if (event.deltaY > 0) {\n        image.prev();\n      } else if (event.deltaY < 0) {\n        image.next();\n      }\n    }\n\n    // ---------------------------------------------\n    // touch handler\n    // ---------------------------------------------\n    let startIndex: number = -1;\n    let startPoint: { x: number; y: number } | null = null;\n\n    function touchStart(event: TouchEvent) {\n      if (event.targetTouches.length !== 2) return;\n\n      event.stopPropagation();\n      event.stopImmediatePropagation();\n      event.preventDefault();\n\n      startIndex = image.getIndex();\n\n      startPoint = {\n        x: event.targetTouches[0].pageX,\n        y: event.targetTouches[0].pageY,\n      };\n\n      if (!element) {\n        throw new Error(`undefined element!!!`);\n      }\n\n      element.removeEventListener('touchstart', touchStart);\n\n      element.addEventListener('touchmove', touchMove);\n      element.addEventListener('touchend', touchEnd);\n      element.addEventListener('touchcancel', touchEnd);\n    }\n\n    function touchMove(event: TouchEvent) {\n      if (event.targetTouches.length !== 2 || event.changedTouches.length !== 2 || !startPoint) return;\n\n      event.stopPropagation();\n      event.stopImmediatePropagation();\n      event.preventDefault();\n\n      const dx: number = event.targetTouches[0].pageX - startPoint.x;\n      const dy: number = event.targetTouches[0].pageY - startPoint.y;\n      const d: number = touchDirection === 'vertical' ? dy : dx;\n\n      image.goto(startIndex + Math.floor(d / 10));\n    }\n\n    function touchEnd(event: TouchEvent) {\n      if (!element) {\n        throw new Error(`undefined element!!!`);\n      }\n\n      element.removeEventListener('touchmove', touchMove);\n      element.removeEventListener('touchend', touchEnd);\n      element.removeEventListener('touchcancel', touchEnd);\n\n      element.addEventListener('touchstart', touchStart);\n    }\n\n    // ---------------------------------------------\n    // start\n    // ---------------------------------------------\n    element.addEventListener('wheel', wheel);\n\n    if (isTouchDevice()) {\n      element.addEventListener('touchstart', touchStart);\n    }\n\n    // ---------------------------------------------\n    // end\n    // ---------------------------------------------\n    return () => {\n      element.removeEventListener('wheel', wheel);\n\n      element.removeEventListener('touchstart', touchStart);\n\n      element.removeEventListener('touchmove', touchMove);\n      element.removeEventListener('touchend', touchEnd);\n      element.removeEventListener('touchcancel', touchEnd);\n    };\n  }, [image, element, enabled, touchDirection]);\n}\n\n/** @deprecated use useSeriesImageScroll */\nexport const useBulkImageScroll = useSeriesImageScroll;\n"},846:function(e,n,t){"use strict";t.r(n);var r=t(666),o=t(0),i=t.n(o),s=t(668);Object(r.installWADOImageLoader)(),n.default=()=>{const[e,n]=Object(o.useState)(()=>[]),t=Object(o.useMemo)(()=>new r.CornerstoneSeriesImage(s.map(e=>`wadouri:https://fixtures.front.lunit.io/dcm-files/series/${e}`),{unload:r.unloadImage}),[]),{current:a,end:l}=Object(r.useSeriesImagePosition)(t),[c,m]=Object(o.useState)(null);return Object(r.useSeriesImageScroll)({image:t,element:c}),Object(o.useEffect)(()=>{const e=t.progress.subscribe(e=>{n(n=>[...n,`[progress]: ${Math.floor(100*e)}%`])}),r=t.image.subscribe(e=>{console.warn("cornerstoneImage:",e),n(n=>[...n,`[image]: ${null===e||void 0===e?void 0:e.imageId}`])});return()=>{e.unsubscribe(),r.unsubscribe()}},[t]),i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{position:"absolute",top:0,left:0,padding:10,backgroundColor:"gray"}},i.a.createElement("button",{onClick:()=>t.prev()},"PREV"),i.a.createElement("button",{onClick:()=>t.next()},"NEXT"),i.a.createElement("hr",null),i.a.createElement("div",null,a," / ",l),i.a.createElement("div",{ref:m,style:{width:150,height:200,backgroundColor:"red"}},"Scroll here!")),i.a.createElement("ul",{style:{fontSize:11,marginLeft:180}},e.map((e,n)=>i.a.createElement("li",{key:n},e))))}},847:function(e,n,t){"use strict";t.r(n),n.default="import {\n  CornerstoneSequenceImage,\n  CornerstoneSeriesImage,\n  installWADOImageLoader,\n  unloadImage,\n  useSeriesImagePosition,\n  useSeriesImageScroll,\n} from '@lunit/insight-viewer';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport series from '../../../__fixtures__/series.json';\n\ninstallWADOImageLoader();\n\nexport default () => {\n  const [log, setLog] = useState<string[]>(() => []);\n\n  const image: CornerstoneSequenceImage = useMemo(\n    () =>\n      new CornerstoneSeriesImage(\n        series.map(p => `wadouri:https://fixtures.front.lunit.io/dcm-files/series/${p}`),\n        { unload: unloadImage },\n      ),\n    [],\n  );\n\n  const { current, end } = useSeriesImagePosition(image);\n\n  const [scrollTargetElement, setScrollTargetElement] = useState<HTMLElement | null>(null);\n\n  useSeriesImageScroll({\n    image,\n    element: scrollTargetElement,\n  });\n\n  useEffect(() => {\n    // progress \uc815\ubcf4\ub97c \ubc1b\ub294\ub2e4\n    const progressSubscription = image.progress.subscribe((progress: number) => {\n      setLog(prevLog => [...prevLog, `[progress]: ${Math.floor(progress * 100)}%`]);\n    });\n\n    // image \uc815\ubcf4\ub97c \ubc1b\ub294\ub2e4\n    const imageSubscription = image.image.subscribe((cornerstoneImage: cornerstone.Image | null) => {\n      console.warn('cornerstoneImage:', cornerstoneImage);\n      setLog(prevLog => [...prevLog, `[image]: ${cornerstoneImage?.imageId}`]);\n    });\n\n    return () => {\n      progressSubscription.unsubscribe();\n      imageSubscription.unsubscribe();\n    };\n  }, [image]);\n\n  return (\n    <>\n      <div style={{ position: 'absolute', top: 0, left: 0, padding: 10, backgroundColor: 'gray' }}>\n        <button onClick={() => image.prev()}>PREV</button>\n        <button onClick={() => image.next()}>NEXT</button>\n        <hr />\n        <div>\n          {current} / {end}\n        </div>\n        <div ref={setScrollTargetElement} style={{ width: 150, height: 200, backgroundColor: 'red' }}>\n          Scroll here!\n        </div>\n      </div>\n      <ul style={{ fontSize: 11, marginLeft: 180 }}>\n        {log.map((line, i) => (\n          <li key={i}>{line}</li>\n        ))}\n      </ul>\n    </>\n  );\n};\n"},848:function(e,n,t){"use strict";t.r(n);var r=t(666),o=t(0),i=t.n(o),s=t(668);Object(r.installWADOImageLoader)(),n.default=()=>{const e=Object(o.useMemo)(()=>new r.CornerstoneSeriesImage(s.map(e=>`wadouri:https://fixtures.front.lunit.io/dcm-files/series/${e}`),{unload:r.unloadImage}),[]),n=Object(o.useMemo)(()=>"scroll",[]),[t,a]=Object(o.useState)(null);Object(r.useSeriesImageScroll)({image:e,element:t,enabled:"scroll"===n});const l=Object(r.useViewerInteractions)(["pan",n],{element:t});return i.a.createElement(r.InsightViewerContainer,{ref:a,width:400,height:500},i.a.createElement(r.CornerstoneViewer,{width:400,height:500,invert:!1,flip:!1,interactions:l,resetTime:0,image:e,updateCornerstoneRenderData:()=>{}}))}},849:function(e,n,t){"use strict";t.r(n),n.default="import {\n  CornerstoneSequenceImage,\n  CornerstoneSeriesImage,\n  CornerstoneViewer,\n  InsightViewerContainer,\n  installWADOImageLoader,\n  unloadImage,\n  useSeriesImageScroll,\n  useViewerInteractions,\n} from '@lunit/insight-viewer';\nimport React, { useMemo, useState } from 'react';\nimport series from '../../../__fixtures__/series.json';\n\ninstallWADOImageLoader();\n\nexport default () => {\n  const image: CornerstoneSequenceImage = useMemo(\n    () =>\n      new CornerstoneSeriesImage(\n        series.map((p) => `wadouri:https://fixtures.front.lunit.io/dcm-files/series/${p}`),\n        { unload: unloadImage },\n      ),\n    [],\n  );\n\n  const wheel = useMemo<'zoom' | 'scroll'>(() => 'scroll', []);\n\n  const [element, setElement] = useState<HTMLElement | null>(null);\n\n  useSeriesImageScroll({\n    image,\n    element,\n    enabled: wheel === 'scroll',\n  });\n\n  const interactions = useViewerInteractions(['pan', wheel], { element });\n  // \uc544\ub798\uc640 \ub3d9\uc77c\ud558\ub2e4\n  //const interactions = useMemo(\n  //  () => [\n  //    pan({ element }), // pan\n  //    wheel === 'zoom' && zoom({ element }), // zoom\n  //  ],\n  //  [element, wheel],\n  //);\n\n  return (\n    <InsightViewerContainer ref={setElement} width={400} height={500}>\n      <CornerstoneViewer\n        width={400}\n        height={500}\n        invert={false} // \uc0c9\uc0c1\uc744 \ubc18\uc804\ud55c\ub2e4\n        flip={false} // \uc774\ubbf8\uc9c0\ub97c \uc88c\uc6b0\ub85c \ub4a4\uc9d1\ub294\ub2e4\n        interactions={interactions}\n        resetTime={0} // \uc774 \uac12\uc774 \ubcc0\uacbd\ub418\uba74 Pan, Adjust, Zoom \uc0c1\ud0dc\uac00 \ucd08\uae30\ud654 \ub41c\ub2e4\n        image={image}\n        updateCornerstoneRenderData={() => {}}\n      />\n    </InsightViewerContainer>\n  );\n};\n"},940:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return a}));t(0);var r=t(62),o=t(7),i=t(89);const s={};function a({components:e,...n}){return Object(r.b)("wrapper",Object.assign({},s,n,{components:e,mdxType:"MDXLayout"}),Object(r.b)("h1",null,Object(r.b)("inlineCode",{parentName:"h1"},"useSeriesImageScroll()")),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"CornerstoneSeriesImage"),"\ub97c Mouse Wheel\uc744 \uc0ac\uc6a9\ud574\uc11c Navigation \ud558\ub294\ub370 \uc0ac\uc6a9\ud55c\ub2e4."),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"EventTarget"),"\uc73c\ub85c \uc0ac\uc6a9\ud560 ",Object(r.b)("inlineCode",{parentName:"p"},"HTMLElement"),"\ub97c \ud544\uc694\ub85c \ud55c\ub2e4."),Object(r.b)("h1",null,"API"),Object(r.b)(i.Example,{example:Object(o.d)("@lunit/insight-viewer/hooks/useSeriesImageScroll",{source:t(845),filename:"src/_packages/@lunit/insight-viewer/hooks/useSeriesImageScroll.ts"}),api:!0,mdxType:"Example"}),Object(r.b)("h1",null,"Sample"),Object(r.b)(i.Example,{example:Object(o.b)("./useSeriesImageScroll/Basic",{component:t(846),source:t(847),filename:"src/_packages/@lunit/insight-viewer/__pages__/Hooks/useSeriesImageScroll/Basic.tsx"}),mdxType:"Example"},Object(r.b)(i.Preview,{height:380,style:{overflowY:"auto"},mdxType:"Preview"})),Object(r.b)("h1",null,Object(r.b)("inlineCode",{parentName:"h1"},"<CornerstoneViewer>"),"\uc640 \ud568\uaed8 \uc0ac\uc6a9"),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"<InsightViewerContainer ref={}>"),"\ub97c \ud1b5\ud574 ",Object(r.b)("inlineCode",{parentName:"p"},"HTMLElement"),"\ub97c \ubc1b\uc544\uc11c \ucc98\ub9ac\ud560 \uc218 \uc788\ub2e4."),Object(r.b)(i.Example,{example:Object(o.b)("./useSeriesImageScroll/InsightViewer",{component:t(848),source:t(849),filename:"src/_packages/@lunit/insight-viewer/__pages__/Hooks/useSeriesImageScroll/InsightViewer.tsx"}),mdxType:"Example"},Object(r.b)(i.Preview,{height:520,mdxType:"Preview"})))}a.isMDXComponent=!0}}]);
//# sourceMappingURL=21.45b5470106c6da231db7.js.map
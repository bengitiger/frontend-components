(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{668:function(e){e.exports=JSON.parse('["CT000000.dcm","CT000001.dcm","CT000002.dcm","CT000003.dcm","CT000004.dcm","CT000005.dcm","CT000006.dcm","CT000007.dcm","CT000008.dcm","CT000009.dcm","CT000010.dcm","CT000011.dcm","CT000012.dcm","CT000013.dcm","CT000014.dcm","CT000015.dcm","CT000016.dcm","CT000017.dcm","CT000018.dcm","CT000019.dcm","CT000020.dcm","CT000021.dcm","CT000022.dcm","CT000023.dcm","CT000024.dcm","CT000025.dcm","CT000026.dcm","CT000027.dcm","CT000028.dcm","CT000029.dcm","CT000030.dcm"]')},865:function(e,n,t){"use strict";t.r(n),n.default="import React, {\n  Consumer,\n  Context,\n  createContext,\n  ReactNode,\n  useCallback,\n  useContext,\n  useEffect,\n  useState,\n} from 'react';\nimport { CornerstoneSingleImage } from '../image/CornerstoneSingleImage';\nimport { CornerstoneImage } from '../image/types';\n\nexport interface ImageStoreProviderProps {\n  children: ReactNode;\n\n  /** \ucd5c\ub300 Cache \uac2f\uc218 - \ub192\uc744\uc218\ub85d Memory\uc5d0 \uc601\ud5a5\uc744 \ubbf8\uce58\uac8c \ub41c\ub2e4. */\n  cacheImages?: number;\n\n  /** CornerstoneImage factory */\n  factory?: (imageId: string) => CornerstoneImage;\n}\n\nexport interface ImageStoreState {\n  /** CornerstoneImage\ub97c Load \ud55c\ub2e4 */\n  fetch: (imageId: string) => CornerstoneImage;\n\n  /** Cache\ub97c \uc9c0\uc6b4\ub2e4 */\n  purge: (imageId: string) => void;\n}\n\n// @ts-ignore\nconst ImageStoreContext: Context<ImageStoreState> = createContext<ImageStoreState>();\n\nfunction defaultFactory(imageId: string): CornerstoneImage {\n  return new CornerstoneSingleImage(imageId);\n}\n\nexport function ImageStoreProvider({ cacheImages = 10, factory = defaultFactory, children }: ImageStoreProviderProps) {\n  const [cache] = useState<[string, CornerstoneImage][]>(() => []);\n\n  const fetch = useCallback(\n    (imageId: string) => {\n      let item = cache.find(([itemImageId]) => itemImageId === imageId);\n\n      if (!item) {\n        item = [imageId, factory(imageId)];\n        cache.push(item);\n\n        if (cache.length > cacheImages) {\n          const deleteCount: number = cache.length - cacheImages;\n          const deleteItems = cache.splice(0, deleteCount);\n\n          for (const deleteItem of deleteItems) {\n            deleteItem[1].destroy();\n          }\n        }\n      }\n\n      return item[1];\n    },\n    [cache, cacheImages, factory],\n  );\n\n  const purge = useCallback(\n    (imageId: string) => {\n      const index = cache.findIndex(([itemImageId]) => itemImageId === imageId);\n\n      if (index > -1) {\n        const deleteItems = cache.splice(index, 1);\n\n        for (const deleteItem of deleteItems) {\n          deleteItem[1].destroy();\n        }\n      }\n    },\n    [cache],\n  );\n\n  useEffect(() => {\n    return () => {\n      for (const deleteItem of cache) {\n        deleteItem[1].destroy();\n      }\n    };\n  }, [cache]);\n\n  return <ImageStoreContext.Provider value={{ fetch, purge }}>{children}</ImageStoreContext.Provider>;\n}\n\nexport function useImageStore(): ImageStoreState {\n  return useContext(ImageStoreContext);\n}\n\nexport const ImageStoreConsumer: Consumer<ImageStoreState> = ImageStoreContext.Consumer;\n"},866:function(e,n,t){"use strict";t.r(n);var r=t(641),i=t(666),o=t(0),a=t.n(o),m=t(668);Object(i.installWADOImageLoader)();const c={width:[600,400,1e3],height:[700,400,1e3],control:["pan",["none","pan","adjust"]],wheel:["zoom",["none","zoom"]],flip:[!1],invert:[!1]},s=m.slice(0,10).map(e=>`wadouri:https://fixtures.front.lunit.io/dcm-files/series/${e}`);function l(){const{fetch:e}=Object(i.useImageStore)(),[n,t]=Object(o.useState)(()=>s[0]),m=Object(o.useMemo)(()=>e(n),[e,n]);return Object(o.useEffect)(()=>{e(s[1]),e(s[2]),e(s[3]),e(s[4])},[e]),a.a.createElement("div",{style:{display:"flex"}},a.a.createElement(i.InsightViewerTestController,{options:c},({width:e,height:n,invert:t,flip:r,control:o,wheel:c,resetTime:s,element:l,setElement:d,interactions:g})=>a.a.createElement(i.InsightViewerContainer,{width:e,height:n},a.a.createElement(i.CornerstoneViewer,{width:e,height:n,invert:t,flip:r,interactions:g,resetTime:s,image:m,updateCornerstoneRenderData:()=>{}}),a.a.createElement(i.ProgressViewer,{width:e,height:n,image:m}))),a.a.createElement("div",null,a.a.createElement("ul",null,s.map((e,n)=>a.a.createElement("li",{key:e},a.a.createElement(r.a,{onClick:()=>t(e)},"Show Image ",n))))))}n.default=()=>a.a.createElement(i.ImageStoreProvider,null,a.a.createElement(l,null))},867:function(e,n,t){"use strict";t.r(n),n.default="import {\n  CornerstoneImage,\n  CornerstoneViewer,\n  ImageStoreProvider,\n  InsightViewerContainer,\n  InsightViewerControllerOptions,\n  InsightViewerTestController,\n  installWADOImageLoader,\n  ProgressViewer,\n  useImageStore,\n} from '@lunit/insight-viewer';\nimport { Button } from '@material-ui/core';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport series from '../../../__fixtures__/series.json';\n\ninstallWADOImageLoader();\n\nconst controllerOptions: InsightViewerControllerOptions = {\n  width: [600, 400, 1000],\n  height: [700, 400, 1000],\n  control: ['pan', ['none', 'pan', 'adjust']],\n  wheel: ['zoom', ['none', 'zoom']],\n  flip: [false],\n  invert: [false],\n};\n\nconst imageIds: string[] = series\n  .slice(0, 10)\n  .map((p) => `wadouri:https://fixtures.front.lunit.io/dcm-files/series/${p}`);\n\nfunction Sample() {\n  const { fetch } = useImageStore();\n\n  const [imageId, setImageId] = useState<string>(() => imageIds[0]);\n\n  const image = useMemo<CornerstoneImage>(() => fetch(imageId), [fetch, imageId]);\n\n  useEffect(() => {\n    // 1 ~ 4\ubc88 \uc774\ubbf8\uc9c0\ub4e4\uc744 Prefetch \ud55c\ub2e4\n    // 1 ~ 4\ubc88 \uc774\ubbf8\uc9c0\ub4e4\uc740 \ube60\ub974\uac8c \ub728\uac8c \ub420 \uac83\uc774\ub2e4\n    fetch(imageIds[1]);\n    fetch(imageIds[2]);\n    fetch(imageIds[3]);\n    fetch(imageIds[4]);\n  }, [fetch]);\n\n  return (\n    <div style={{ display: 'flex' }}>\n      <InsightViewerTestController options={controllerOptions}>\n        {({ width, height, invert, flip, control, wheel, resetTime, element, setElement, interactions }) => (\n          <InsightViewerContainer width={width} height={height}>\n            <CornerstoneViewer\n              width={width}\n              height={height}\n              invert={invert}\n              flip={flip}\n              interactions={interactions}\n              resetTime={resetTime}\n              image={image}\n              updateCornerstoneRenderData={() => {}}\n            />\n            <ProgressViewer width={width} height={height} image={image} />\n          </InsightViewerContainer>\n        )}\n      </InsightViewerTestController>\n      <div>\n        <ul>\n          {imageIds.map((imageId, i) => (\n            <li key={imageId}>\n              <Button onClick={() => setImageId(imageId)}>Show Image {i}</Button>\n            </li>\n          ))}\n        </ul>\n      </div>\n    </div>\n  );\n}\n\n// \uc0c1\uc704\uc5d0 <ImageStoreProvider>\uac00 \ubc18\ub4dc\uc2dc \ud544\uc694\ud558\ub2e4\nexport default () => (\n  <ImageStoreProvider>\n    <Sample />\n  </ImageStoreProvider>\n);\n"},944:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return c}));t(0);var r=t(62),i=t(7),o=t(89),a=t(667);const m={};function c({components:e,...n}){return Object(r.b)("wrapper",Object.assign({},m,n,{components:e,mdxType:"MDXLayout"}),Object(r.b)("h1",null,Object(r.b)("inlineCode",{parentName:"h1"},"useImageStore()")),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"*.dcm")," \ud30c\uc77c\uc744 Prefetch \ud558\uae30 \uc704\ud574 \uc0ac\uc6a9\ud55c\ub2e4."),Object(r.b)("p",null,"\uc0ac\uc6a9\uc790\uac00 \ub2e4\uc74c\uc5d0 \ubcfc \uac83\uc774\ub77c \uc608\uc0c1\ub418\ub294 ",Object(r.b)("inlineCode",{parentName:"p"},"CornerstoneImage"),"\ub97c \ubbf8\ub9ac Prefetch \ud560 \uc218 \uc788\ub2e4."),Object(r.b)("h1",null,"API"),Object(r.b)(o.Example,{example:Object(i.d)("@lunit/insight-viewer/hooks/useImageStore",{source:t(865),filename:"src/_packages/@lunit/insight-viewer/hooks/useImageStore.tsx"}),api:!0,mdxType:"Example"}),Object(r.b)("h1",null,"Sample"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"\ud604\uc7ac 1\ubc88 Image\ub97c \ubcf4\uace0 \uc788\ub2e4\uba74"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"useEffect(() => fetch(imageIds[2]), [imageIds])")," \uc774\uc640 \uac19\uc740 \uc2dd\uc73c\ub85c 2\ubc88 \uc774\ubbf8\uc9c0\ub97c Prefetch \ud55c\ub2e4")),Object(r.b)(o.Example,{example:Object(i.b)("./useImageStore/Basic",{component:t(866),source:t(867),filename:"src/_packages/@lunit/insight-viewer/__pages__/Hooks/useImageStore/Basic.tsx"}),mdxType:"Example"},Object(r.b)(a.a,{height:720,mdxType:"InsightViewerPreview"})))}c.isMDXComponent=!0}}]);
//# sourceMappingURL=28.45b5470106c6da231db7.js.map